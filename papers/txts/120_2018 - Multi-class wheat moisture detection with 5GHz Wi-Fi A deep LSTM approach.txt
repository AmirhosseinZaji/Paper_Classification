Multi-Class Wheat Moisture Detection with 5GHzWi-Fi: Deep LSTM ApproachyWeidong Yang,zXuyu Wang,yShui Cao,yHui Wang, andzShiwen MaoyCollege of Information Science and Engineering, Henan University of Technology, Zhengzhou, Henan, P.R. China 450066zDepartment of Electrical and Computer Engineering, Auburn University, Auburn, AL 36849-5201 USAEmail: Yangweidong@haut.edu.cn, xzw0029@tigermail.auburn.edu, iscshuai@163.com, detewhkn@gmail.com, smao@ieee.orgAbstract —Moisture content of cereal grains is highly im-portant factor in safe storage and food processing. The existingdetection methods are either time-consuming, sensitive to theenvironment, or have high cost. In this paper, we proposeDeepWMD, deep LSTM network based system for multi-classwheat moisture detection. We ﬁrst collect CSI amplitude andphase difference data to detect wheat moisture content. Then,we design the DeepWMD system with commodity Wi-Fi devicesin the 5GHz band, including data preprocessing of collectedCSI data, ofﬂine training, and online testing. Our experimentalresults verify the efﬁcacy of the proposed DeepWMD system,and demonstrates that DeepWDM can achieve high-precisionmulti-class wheat moisture detection in different indoor storageenvironments.Index Terms —Channel state information (CSI); commodityWi-Fi; phase difference; wheat moisture detection; deep learning;long short-term memory (LSTM).I. INTRODUCTIONWith the growth of the world population and the improve-ment of people’s life quality, the demands on the qualityand quantity of cereal grains become more stringent, and areincreasing rapidly every year [1]–[5]. In fact, more than twobillion tons of grain are harvested annually [6]. How to storesafely the harvested grains for meeting the future grain demandbecomes highly important, especially for emergency demandscenarios such as famine or natural disasters [7]. Two physicalfactors, including moisture content and temperature, greatlyinﬂuence the safe storage of grains [6]. Compared with thetemperature factor, moisture content of cereal grains is moreimportant in different phases of the grain distribution chainbetween the producer and consumer, which is one of the mostimportant factors that determine quality. It is also an importantfactor in determining the proper time for harvesting, and hasgreat inﬂuence on safe storage and selling price.The existing grain moisture content measurement tech-niques include destructive methods [8] and non-destructivemethods [9]–[14]. The destructive methods, such as oven-drying [8], are usually time-consuming, which requires ovendrying for speciﬁc time periods at speciﬁc temperature. Thus,the destructive methods are not proper for widely deploymentin the grain trade. On the other hand, non-destructive methodsuse the electric properties or the magnetic ﬁeld to determinethe grain moisture content, which require less man power andare less time-consuming. However, the exiting non-destructivemethods still have some limitations. For example, the capac-itive method has the shortcoming that the measured grainmoisture values are sensitive to the environment temperatureand the grain ﬂow velocity in the dryer [9]. Moreover, althoughthe resistance method [10], the microwave method [11], [12],and the neutron method [13] can obtain high accuracy andand achieve fast detection, the detection devices for these non-destructive methods entail high cost.In this paper, we propose to use Wi-Fi Channel stateinformation (CSI) for non-destructive grain moisture contentmeasurement. The CSI represents ﬁne-grained channel in-formation, thus reﬂecting the indoor channel features suchas shadowing fading, multipath effect, and distortion [15].Moreover, CSI amplitude data [16], [17] and phase differencedata [18] have been shown to be highly stable, compared withreceived signal strength (RSS). By modifying the open-sourcedevice driver for off-the-shelf Wi-Fi network interface cards(NIC), we can read CSI values for received Wi-Fi packetsfrom all the three antennas of the IEEE 802.11n NIC. Forexample, using Intel Wi-Fi Link 5300 NIC [15] and Atheros9380 NIC [19], we can extract 90 CSI values and 168 CSIvalues for each received packet from the three antennas forthe 20 MHz Wi-Fi channel, respectively, while the NIC canoperate either in 2.4 GHz or GHz. Moreover, the stable phasedifference data in GHz can be obtain when the transmitterand the receiver are equipped with the Intel Wi-Fi Link 5300NIC, and are set in the inject model and monitoring model,respectively [18].Recently, CSI data has been employed for indoor lo-calization and device-free sensing. For indoor localization,DeepFi [16], [17] and FIFS [20] systems are based on CSIamplitude values for ﬁngerprinting based localization; thePhaseFi [21], [22] and the BiLoc system [18] employ cali-brated CSI phase data and bimodal CSI data as ﬁngerprintsfor indoor localization, respectively, using deep autoen-coder network. To improve localization accuracy and reducedata storage, the CiFi system [23] and ResLoc system [24]leverage CSI images and tensor for indoor localization, us-ing deep convolution network and deep residual sharinglearning, respectively. On the other hand, CSI data has been978-1-5386-5156-8/18/$31.00 ©2018 IEEEused for device-free sensing, including fall detection, activityrecognition, and breathing and heart rates monitoring. Forfall detection, RT-Fall [25] and WiFall [26] consider CSIphase differences and amplitude to detect the fall of patient,respectively. For activity recognition, E-eyes system [27] andThe CARM system [28] can effectively recognize the differentactivity in indoor environments. For breathing and heart ratemonitoring, PhaseBeat [29] and TensorBeat [30] exploit CSIphase difference data to monitor single or multiple persons’breathing rates. Motivated by the existing CSI-based sensingtechniques, our previous work has used CSI amplitude andphase difference data for wheat moisture detection, which isa binary classiﬁcation method for detection of anomaly wheatmoisture content [31].In this paper, we focus on the multi-class wheat moisturecontent detection using CSI amplitude and phase differencedata using 5GHz Wi-Fi, which is different from the anomalydetection of wheat moisture with support vector machine(SVM) based binary classiﬁcation method [31]. In our exper-iments, we collect CSI amplitude and phase difference dataon ﬁve different levels of wheat moisture content, rangingfrom 10.6% to 14.9%, in order to achieve multi-class wheatmoisture content detection. We ﬁnd that although most of thewheat moisture content levels have different CSI amplitudeor phase difference values, there are still highly similar CSIvalues for different wheat moisture content levels, whichbrings challenge for multi-class wheat moisture detectionusing traditional machine learning methods such as SVM.Thus, we exploit the deep long short-term memory (LSTM)method to handle the above similar CSI values for achievinga higher detection accuracy. In fact, the deep LSTM networkhas stronger data representation capability than traditionalmachine learning methods [32], [33], which has been suc-cessfully applied for speech recognition [34], human activityrecognition [35], and indoor localization [36].In particular, we design DeepWMD, Deep LSTM networkbased multi-class WheatMoisture Content Detection system.The proposed DeepWMD system includes data prepro-cessing module to collect CSI amplitude or phase differencedata, and then normalize the amplitudes or phase differencesof CSI data. The DeepWMD system has an ofﬂine trainingphase, where two-layer deep LSTM network and softmaxclassiﬁer are trained with collected data. The deep LSTMnetwork can achieve stronger learning and representationability. Moreover, the softmax classiﬁer uses the cross-entropyto measure the difference between true labeled data and thenormalized output data, and employs L2 regularization toavoid over-ﬁtting. The back propagation through time (BPTT)algorithm is incorporated for training the deep LSTM network.For the online phase, an improved predication method isdeveloped for determining wheat moisture content level withnewly received CSI amplitude or phase difference data.The main contributions of this paper are summarized asfollows:0 10 20 30 40 50100120140160180200220240Subcarrier IndexCSI Amplitude (dB) Antenna 1Antenna 2Antenna 3Fig. 1. CSI amplitude measurements for different antennas over subcarriersin LOS environment.We validate the feasibility of using ﬁne-grained CSIamplitude and phase difference data for multi-class wheatmoisture detection. To the best of our knowledge, this isthe ﬁrst work that leverages deep LSTM network todetect multi-class wheat moisture.We design the DeepWMD system, which collects CSIamplitude and phase difference data to train the deepLSTM network, respectively, and then employ newlyreceived CSI data for determining the moisture content ofcereal wheat. The DeepWMD system includes data pre-processing, ofﬂine training, and online testing modules.We also implement DeepWMD on two off-the-shelf lap-top computers with commodity Wi-Fi cards. The exper-iment results demonstrate that the proposed DeepWMDsystem can achieve considerably high classiﬁcation ac-curacy in both line-of-sight (LOS) and non-line-of-sign(NLOS) scenarios.The remainder of this paper is organized as follows. Thepreliminaries are discussed in Section II. We present theDeepWMD system design in Section III and evaluate itsperformance in Section IV. Section concludes this paper.II. RELIMINARIES AND FEASIBILITYA. Channel State InformationModern wireless communication systems such Wi-Fi andLTE mainly adopt OFDM techniques in the Physical Layer(PHY) [37]. The OFDM technique can separate the totalspectrum into multiple orthogonal subcarriers, where data canbe sent over subcarriers for addressing the frequency selectionfading in complex indoor scenarios [38]. For the OFDMtechnique in Wi-Fi system, the subcarriers can considered asnarrowband ﬂat fading channels. We deﬁne Hias the CSIvalue of the ith subcarrier, that isHi=jHijexpfj\Hig; (1)0 10 20 30 40 501.51.551.61.651.71.751.81.85Subcarrier IndexCSI Phase Difference Antenna and 2Antenna and 3Antenna and 1Fig. 2. CSI phase difference measurements for different antenna pairs oversubcarriers in LOS environment.0 200 400 600 800 1000 1200 1400 1600 1800Packet Index0510152025303540CSI Amplitude (dB)MoistureContent(10.6%)MoistureContent(11.3%)MoistureContent(14.1%)MoistureContent(14.9%)MoistureContent(12.7%)Fig. 3. CSI amplitude measurements for ﬁve different wheat moisturecontents.where jHijand\Hiare the amplitude and phase informationfor the ith subcarrier, respectively.Recently, CSI data has been leveraged for RF sensing suchas fall detection, activity recognition, breathing and heartrate monitoring, and indoor localization [16], [29], [39]–[41],because CSI data can offer ﬁne-grained channel information,reﬂecting indoor channel characteristics such as distortion,multipath effect, and shadowing fading. For example, Fig. 1and Fig. show CSI amplitude and phase difference mea-surements over subcarriers in the LOS environment using theAtheros 9380 NIC, respectively. We can see that the CSI valuesare highly different for different antennas over subcarriers,which can be used for multi-class wheat moisture detectionusing the deep LSTM network.B. Our Experiment ObservationWe ﬁrst experimentally verify the feasibility of using CSIamplitude and phase difference data for wheat moisture de-0 200 400 600 800 1000 1200 1400 1600 1800Packet Index-2-1.5-1-0.500.511.52CSI Phase DifferenceMoistureContent(10.6%)MoistureContent(11.3%)MoistureContent(12.7%)MoistureContent(14.1%)MoistureContent(14.9%)Fig. 4. CSI phase difference measurements for ﬁve different wheat moisturecontents.tection, using the binary classiﬁcation SVM based methodproposed in our prior work [31] for anomaly detection ofwheat moisture content. In this experiment, we collect CSIamplitude and phase difference data that pass through wheatover ﬁve moisture content levels, ranging from 10.6% to14.9%. Fig. shows the CSI amplitude measurements for ﬁvedifferent wheat moisture content levels. It is noticed that formost of the wheat moisture content levels, the correspondingCSI amplitude values are different. However, when the wheatmoisture contents are 11.3% and 14.1%, the CSI amplitudevalues are close to each other, which leads to big challengefor distinguishing these two content levels.Fig. shows the CSI phase difference measurements forﬁve different wheat moisture content levels. As we can see,different wheat moisture content levels has also different CSIphase difference values. Only for wheat moisture contentlevels at 11.3% and 12.7%, the CSI phase difference valuesare close to each other. To deal with such cases, we propose toleverage deep LSTM network to achieve higher multi-classwheat moisture detection accuracy. This is because the deepLSTM network has stronger data representation capabilitythan traditional machine learning methods such as SVM.III. HEDEEPWMD YSTEM DESIGNA. DeepWMD System ArchitectureThe DeepWMD system consists of two Wi-Fi devices, whileone is set as the transmitter and the other as the receiver.Both of them are equipped with an Intel Wi-Fi link 5300 NIC.Moreover, to obtain GHz CSI amplitude and phase differencedata, the transmitter and receiver are conﬁgured in the injectionmode and the monitoring mode respectively.Fig. shows the proposed DeepWMD system, includingdata preprocessing, ofﬂine training, and online testing com-ponents. First, the DeepWMD system calibrates the collectedwheat moisture data to obtain clear CSI data sequence. Then,for ofﬂine training, the DeepWMD system employs use cap-tured data from ﬁve different moisture content levels to train adeep LSTM network, while softmax classiﬁer is used in thetop layer for classiﬁcation. The LSTM model can effectivelyhandle sequence based data, and also has strong classiﬁcationcapability for multi-class wheat moisture detection. For onlinetesting, the newly collected CSI data is fed into the well-trained LSTM model to detect the closest wheat moisture levelamong ﬁve known, different wheat moisture content levels.B. Data PreprocessingWe measure CSI data from ﬁve wheat piles with differentmoisture content levels. In this experiment, we transmit 1000packets and collect the corresponding CSI amplitude and phasedifference data for each training moisture content level. Thus,the size of training data is 5000 packets for all training mois-ture content levels. For online moisture estimation, DeepWDMcollects CSI data from 200 packets for each test moisture level.In order to improve wheat moisture detection accuracy, theinput values should be limited in the range (0,1) for LSTMclassiﬁcation. Thus we choose zero mean normalizationapproach (Z-score standardization) to normalize the CSI am-plitudes and phase differences data. The normalized value Ziis computed byzi=xi; (2)where xirepresents the raw CSI data in the ith packet, and2are the mean and variance of the original data set,respectively.C. Ofﬂine TrainingFor ofﬂine training, we design deep LSTM network withtwo layers for multi-class wheat moisture detection usingfeatures of different humidity levels from CSI data. The ofﬂinetraining module consists of deep LSTM network and asoftmax classiﬁer.1) Deep LSTM Network: The LSTM network is consideredas type of recurrent neural network (RNN), which caneffectively handle long-range dependency in the dataset [32],[33]. It also overcomes the issues of vanishing or explodinggradients found in traditional RNNs. The LSTM networkcan leverage temporal information of CSI data for multi-class wheat moisture detection, where the hidden LSTM unitscan map input CSI data to output label from ﬁve differentwheat moisture levels. As shown in Fig. 6, we design two-layer LSTM network to achieve stronger CSI data learningrepresentation, thus improving the classiﬁcation accuracy.Moreover, we leverage the LSTM network to implement amapping from the normalized CSI data z= (z1; z2; :::; T)over different time slots from t= toT, to an output label !"#$%&'()$*+"%,#$#%-'.."/$('0 ,#$#%1+"2+'/"))(03 &'()$*+"%4 5+#(0(03%,#$#&'()$*+"%6 5+#(0(03%,#$#,""2%785&%9"$:'+; 5+#(0(03% "(3!$)<0.(0"%1+"=(/$('0 &'()$*+"%> 5")$(03%,#$#<??7@9A <97@9A !"#$%&'()$*+"%,"$"/$('0%B")*.$Fig. 5. The system architecture of DeepWMD.y, which is formulated byit=(!ixzt+!imht1+bi) (3)ft=(!fxzt+!fmht1+bf) (4)ot=(!oxzt+!omht1+bo) (5)gt= tanh( !cxzt+!cmht1+bc) (6)ct=ft⊙ct1+it⊙gt (7)ht=ot⊙tanh( ct); (8)where the !terms are the matrices of weights; the btermsare the bias vectors; tanh is the hyperbolic tangent function,is the sigmoid function; i,f,o,g care the input gate,forget gate, output gate, candidate values, and cell activation,respectively; hdenotes the cell output activation vector; and ⊙is the element-wise product of vectors. For the LSTM network,different gates control different data ﬂows. For example, theinput gate decides how much new data will be utilized in thecurrent memory cell, and the forget gate decides how muchdata will be removed from the old memory cell. The outputgate controls how much information will be output from thecurrent memory cell. Using these gates, the LSTM networkcan effectively achieve multi-class wheat moisture detection !"#$%&'()%**+"+,- /0 /0 1/23 4/23 4#1##%54 #%54 664#23 (#23 "#+#7#!##%54 #%54 66. /0 /0 4/1/Fig. 6. The LSTM network architecture for ofﬂine training.utilizing CSI data sequences.2) Softmax Classiﬁer: We use the softmax classiﬁer to trainthe CSI data in the two layer LSTM network, where the outputof the ﬁnal cell’s hidden node in the second layer is as theinput of fully connected layer. We denote the output of thesoftmax function as s= [s1; s2; :::; M], which maps Minputdata vector to Mnormalized output data. We can formulatethe softmax function bysi=ekTf!i∑Mm=1ekTf!m; i= 1;2; :::; M; (9)where !iis the weight vector of the fully connected layer,kfis the output vector of the ﬁnal cell’s hidden node in thesecond layer, and ()Tis the transpose operator.For training LSTM weights, we denote L(!)be the lossfunction with the weight parameter !. To measure the dif-ference between the normalized output data and the truelabel data, cross-entropy metric is employed. Moreover, weadopt L2regularization hyperparameter to reduce the spaceof solutions, thus avoiding over-ﬁtting. We formulate the lossfunction bymaxL(!) =M∑i=1yilog(si) +2∥!∥22; (10)where yiis the true labeled data for the ith wheat moisturelevel, and is the hyperparameter for L2regularization. Basedon this loss function, we apply the Backpropagation ThroughTime (BPTT) algorithm to the LSTM network to train theparameters [32], where the Adam Optimizer is utilized to makeLSTM network computationally efﬁcient [42].D. Online ForecastAfter preprocessing Nnewly testing input data, we leveragethe trained deep LSTM model with Mtraining wheat moisturelevels for online prediction. We deﬁne as the output resultsTABLE IMOISTURE CONTENT CALIBRATIONWheat sample 2 4 5Moisture content 10.6% 11.3% 12.7% 14.1% 14.9%(a) The high speed universal disinte-grator.(b) The multi-function Infrared Mois-ture Analyzer.Fig. 7. The oven-drying method.of the Softmax classiﬁer of the deep LSTM model, that is=2666411 12 1N21 22 2N............M1M2 MN37775: (11)To reduce the variance of the output results, we need toobtain the average value of the Noutput results at everymoisture level. We denote ias the average value of the outputdata vector i1,i2, ..., iN] in the ith row. Thus, we canobtain the mean vector as [1,2, ..., M]. Finally, themulti-class wheat moisture detection result Dis obtained byD= argmaxi2f1;2;:::;M gi: (12)IV. XPERIMENTS AND EVALUATIONIn this section, we ﬁrst introduce the moisture contentcalibration operation, and then describe the prototype im-plementation of the DeepWMD system and the details ofexperimental settings. Finally, we evaluate the performanceof DeepWMD with experiments.A. Moisture Level CalibrationWe ﬁrst calibrate the moisture content levels of ﬁve groupsof wheat samples using the oven-drying method [8], whereuses high speed universal disintegrator and multi-functioninfrared moisture analyzer as shown in Fig. 7. The moisturecontent levels are given in Table for all the ﬁve wheatsamples.B. DeepWDM Implementation1) Hardware and Software: We leverage commodity lap-tops and Wi-Fi cards to implement the DeepWMD system. Theprototype includes Dell Latitude 5480 laptop with Intel(R)10.6 11.3 12.7 14.1 14.7Wheat Moisture(%)5060708090100Accuracy of Amplitude(%)(a) CSI amplitude.10.6 11.3 12.7 14.1 14.7Wheat Moisture(%)5060708090100Accuracy of Phase Difference(%) (b) CSI phase difference.Fig. 9. Accuracy of multi-class wheat moisture detection for the LOS scenario.10.6 11.3 12.7 14.1 14.7Wheat Moisture(%)5060708090100Accuracy of Phase Difference(%)(a) CSI amplitude.10.6 11.3 12.7 14.1 14.7Wheat Moisture(%)5060708090100Accuracy of Phase Difference(%) (b) CSI phase difference.Fig. 10. Accuracy of multi-class wheat moisture detection for the NLOS scenario.(a) The LOS experiment scenario. (b) The NLOS experiment scenario.Fig. 8. Experimental setup for DeepWMD.processor Pentium dual-core CPU as receiver, and DellPP18l laptop as transmitter, each installed with an Intel Link5300 Wi-Fi NIC along with modiﬁed device driver. Settingthe transmitter in the injection mode and the receiver in themonitor mode, we inject packets from the transmitter usingone antenna to the receiver using three antennas, and collectCSI data for each received packet.For the system software, the laptops run the 32-bit UbuntuLinux14.04 operating system with kernel 4.1.10+. Then, weemploy an LSTM model with two layers using Tensorﬂowto analyze CSI data and then implement multi-class wheatmoisture detection [43].2) Experiment Scenario: We conduct experiments to eval-uate the performance of DeepWMD system in both LOSand NLOS scenarios in the research laboratory of HenanUniversity of technology, Zhengzhou, P.R. China. We placethe transmitter and the receiver at m distance for boththe LOS 8(a) and NLOS 8(b) scenarios. In the LOS case,the wheat is placed in the middle of the transmitter and thereceiver. We send ICMP ping packets from the transmitter tothe receiver at 1000 packets/s.C. Performance EvaluationWe ﬁrst evaluate the performance of DeepWMD in theLOS scenario. Fig. shows the accuracy of multi-class wheatmoisture detection for the LOS scenario using CSI amplitude(a) and phase difference data (b), respectively. Using CSIamplitude, we can notice that the DeepWMD can obtain thehighest classiﬁcation accuracy for wheat moisture detection,when the wheat moisture content level is 10.6%. For thewheat moisture content level of 14.1% the lowest classiﬁcationaccuracy for wheat moisture detection is 92.23%. Moreover,the average accuracy of ﬁve cases is about 97.53%. On theother hand, when CSI phase difference data is employed,the average accuracy of wheat moisture detection is about99.42%, which is higher than CSI amplitude data. In addition,the classiﬁcation accuracy even reaches to 100% in threecases, 10.6%, 11.3% and 14.1%, respectively. Thus, by usingusing CSI amplitude or phase difference data, the proposedDeepWMD method can obtain high classiﬁcation accuracyfor LOS scenario based on the deep LSTM approach.We then investigate the performance of the proposed Deep-WMD system in the NLOS scenario. Fig. 10 show theaccuracy of classiﬁcation for the NLOS scenario using CSIamplitude (a) and phase difference data (b), respectively. Wecan notice that the classiﬁcation accuracy is above 90% forall the wheat moisture content level using CSI amplitude.Moreover, the average detection accuracy is about 96.9%.On the other hand, the detection accuracy is above 95%for all the wheat moisture content level using CSI phasedifference, and the average classiﬁcation accuracy is about99%, which demonstrates that CSI phase difference can obtainbetter performance than CSI amplitude, because CSI phasedifference can well capture the change of wireless channel.D. Impact of System ParametersFor the impact of parameters on the performance of multi-class wheat moisture detection, we mainly focus on the ratioof training data over test data, the number of layers in LSTMnetwork, and different antennas in LOS and NLOS scenarios.Fig. 11 shows the average detection accuracy for differentratios of training data over test data in LOS scenario. As wecan see, when we use 80% CSI amplitude or phase differencedata for training, the best accuracies for CSI amplitude andphase difference are 97.5% and 99.4%, respectively. Moreover,using only 20% CSI data for training, we obtain that theaverage accuracies for CSI amplitude and phase differenceare 95.0% and 93.9%, respectively, which are still acceptableresults. On the other hand, Fig. 12 shows the average detectionaccuracy for different ratios of training data over test datain NLOS scenario. We can see that when the ratio is above0.6, the average accuracy for CSI amplitude is above 96.%.Moreover, when the ratio is above 0.4, the average accuracyfor CSI amplitude is above 98.0%.0.2 0.4 0.6 0.8Ratio9092949698100Accuracy (%)AmplitudePhase DifferenceFig. 11. Average detection accuracy for different ratios of training data overtest data in LOS scenario.Fig. 13 shows the average detection accuracy for differentnumber of layers in LSTM network over test data in LOSscenario. As we can see, with the increase of the number oflayers from to 2, the average detection accuracy increasesfrom 96.6% to 97.5% using CSI amplitude. When we employCSI phase difference, the average accuracy increases from 99.1% to 99.4%. On the other hand, Fig. 14 shows the averagedetection accuracy for different number of layers in LSTMnetwork over test data in NLOS scenario. The multi-classdetection accuracy for NLOS environment is decreased, com-paring with for LOS environment. In fact, with the increaseof the number of layers from to 2, the average detectionaccuracy will increase from 96.2% to 96.8% and from 98.1%to 99.0% using CSI amplitude and phase difference data,respectively. Thus, increasing number of layers in LSTMnetwork can obtain high multi-class detection performance forLOS and NLOS environments.Fig. 15 shows the average detection accuracy for differentantennas over test data in LOS scenario, where for phasedifference, the antenna 1, 2, and mean the antenna pair1 and 2, the antenna pair and 3, and the antenna pair 3and 1, respectively. We can ﬁnd that for different antennasor antenna pairs, the multi-class detection performance isalmost same in LOS environment. Fig. 16 shows the averagedetection accuracy for different antennas over test data inNLOS scenario, where the phase difference has the samesetting as Fig. 15. We can see that for CSI phase differencedata, the highest detection accuracy is obtained by usingantenna pair and 2. We also ﬁnd that for CSI amplitudedata, the antenna can achieve the best performance. In fact,the multi-class detection performance is almost same in NLOSenvironment. Thus, we only select the antenna for the CSIamplitude method and antenna pair and for the CSI phasedifference method in the above experiments.0.2 0.4 0.6 0.8Ratio859095100Accuracy (%)AmplitudePhase DifferenceFig. 12. Average detection accuracy for different ratios of training data overtest data in NLOS scenario.1 2Number of Layers9596979899100Accuracy (%)AmplitudePhase DifferenceFig. 13. Average detection accuracy for different number of layers in LSTMnetwork over test data in LOS scenario.1 2Number of Layers9596979899100Accuracy (%)AmplitudePhase DifferenceFig. 14. Average detection accuracy for different number of layers in LSTMnetwork over test data in NLOS scenario.1 3Antenna9596979899100Accuracy (%)AmplitudePhase DifferenceFig. 15. Average detection accuracy for different antennas over test data inLOS scenario.1 3Antenna9596979899100Accuracy (%)AmplitudePhase DifferenceFig. 16. Average detection accuracy for different antennas over test data inNLOS scenario.V. ONCLUSIONSIn this paper, we proposed DeepWMD, deep LSTMnetwork based system for multi-class wheat moisture de-tection. The proposed system exploited CSI amplitude andphase difference data from comodity Wi-Fi devices for wheatmosture content detection. We designed and implementedthe DeepWMD system with commodity Wi-Fi devices inthe 5GHz band, which consisting of data preprocessing ofcollected CSI data, ofﬂine training, and online testing modules.Our experimental study demonstrated the efﬁcacy of theproposed DeepWMD system, which was shown to achievehigh-precision multi-class wheat moisture detection for bothLOS and NLOS scenarios.ACKNOWLEDGMENTThis work is supported in part by the US NSF underGrant CNS-1702957, the Wireless Engineering Research andEducation Center (WEREC) at Auburn University, Auburn,AL, USA, and in part by the National Key Research andDevelopment Program of China (2017YFD0401001) and bythe NSFC (61741107).REFERENCES[1]D. Vasisht, et al., “FarmBeats: An IoT platform for data-driven agricul-ture,” in Proc. USENIX NSDI’17 Boston, MA, Mar. 2017, pp. 515–529.[2]Z. Kapetanovic, D. Vasisht, J. Won, R. Chandra, and M. Kimball,“Experiences deploying an always-on farm network,” GetMobile: MobileComputing and Communications vol. 21, no. 2, pp. 16–21, 2017.[3]H. M. Jawad, R. Nordin, S. K. Gharghan, A. M. Jawad, and M. Ismail,“Energy-efﬁcient wireless sensor networks for precision agriculture: Areview,” Sensors vol. 17, no. 8, p. 1781, 2017.[4]P. P. Jayaraman, A. Yavari, D. Georgakopoulos, A. Morshed, and A. Za-slavsky, “Internet of things platform for smart farming: Experiences andlessons learnt,” Sensors vol. 16, no. 11, p. 1884, 2016.[5]S. Wolfert, L. Ge, C. Verdouw, and M.-J. Bogaardt, “Big data in smartfarming–a review,” Agricultural Systems vol. 153, pp. 69–80, 2017.[6]D. S. Jayas, “Storing grains for food security and sustainability,”Agricultural Research vol. 1, no. 1, pp. 21–24, Mar. 2012.[7]Y. Liu, W. Han, Y. Zhang, L. Li, J. Wang, and L. Zheng, “An internet-of-things solution for food safety and quality control: pilot project inchina,” Journal of Industrial Information Integration vol. 3, pp. 1–7,2016.[8]American Society of Agricultural Engineers, “Moisture measurement-unground grain and seeds,” pp. 567–568, Dec. 2001, ASAE Standard.[9]W. Wang and Y. Dai, “A grain moisture detecting system based oncapacitive sensor,” International Journal of Digital Content Technologyand its Applications vol. 5, no. 3, pp. 203–209, Mar. 2011.[10] Z. Liu, Z. Wu, Z. Zhang, W. Wu, and H. Li, “Research on onlinemoisture detector in grain drying process based on v/f conversion,”Hindawi Mathematical Problems in Engineering Journal vol. 2015, p.Article ID 565764, 2015.[11] S. O. Nelson, A. W. Kraszewski, S. Trabelsi, and K. C. Lawrence,“Using cereal grain permittivity for sensing moisture content,” IEEETrans. Instr. Meas. vol. 49, no. 3, pp. 470–475, June 2000.[12] K. Kim, J. Kim, C. Lee, S. Noh, and M. Kim, “Simple instrument formoisture measurement in grain by free-space microwave transmission,”Transactions of the ASABE vol. 49, no. 4, pp. 1089–1093, 2006.[13] Y. Yang, J. Wang, C. Wang et al. “Study on on-line measurement ofgrain moisture content by neutron gauge,” Trans. Chinese Society ofAgricultural Engineering vol. 16, no. 5, pp. 99–101, 2000.[14] D. Nath K, P. Ramanathan, and P. Ramanathan, “Non-destructive meth-ods for the measurement of moisture contents–a review,” Sensor Review ,vol. 37, no. 1, pp. 71–77, Jan. 2017.[15] D. Halperin., W. J. Hu., A. Sheth., and D. Wetherall., “Predictable 802.11packet delivery from wireless channel measurements,” in Proc. ACMSIGCOMM’10 New Delhi, India: ACM, Sept. 2010, pp. 159–170.[16] X. Wang, L. Gao, S. Mao, and S. Pandey, “CSI-based ﬁngerprintingfor indoor localization: deep learning approach,” IEEE Trans Veh.Technol. vol. 66, no. 1, pp. 763–776, Jan. 2017.[17] ——, “DeepFi: Deep learning for indoor ﬁngerprinting using channelstate information,” in Proc. WCNC’15 New Orleans, LA, Mar. 2015,pp. 1666–1671.[18] X. Wang, L. Gao, and S. Mao, “BiLoc: Bi-modality deep learning forindoor localization with 5GHz commodity Wi-Fi,” IEEE Access Journal ,vol. 5, no. 1, pp. 4209–4220, Mar. 2017.[19] Y. Xie, Z. Li, and M. Li, “Precise power delay proﬁling with commoditywiﬁ,” in Proceedings of the 21st Annual International Conference onMobile Computing and Networking ACM, 2015, pp. 53–64.[20] J. Xiao, K. Wu., Y. Yi, and L. Ni, “FIFS: Fine-grained indoor ﬁnger-printing system,” in Proc. ICCCN’12 Munich, Germany, Aug. 2012, pp.1–7.[21] X. Wang, L. Gao, and S. Mao, “Csi phase ﬁngerprinting for indoorlocalization with deep learning approach,” IEEE Internet of Things J. ,vol. 3, no. 6, pp. 1113–1123, Dec. 2016.[22] ——, “PhaseFi: Phase ﬁngerprinting for indoor localization with deeplearning approach,” in Proc. GLOBECOM’15 San Diego, CA, Dec.2015, pp. 1–6.[23] X. Wang, X. Wang, and S. Mao, “CiFi: Deep convolutional neuralnetworks for indoor localization with 5GHz Wi-Fi,” in Proc. IEEEICC’17 Paris, France, May 2017, pp. 1–6.[24] ——, “Resloc: Deep residual sharing learning for indoor localizationwith csi tensors,” in Proc. IEEE PIMRC 2017 Montreal, Canada, Oct.2017.[25] H. Wang, D. Zhang, Y. Wang, J. Ma, Y. Wang, and S. Li, “RT-Fall:A real-time and contactless fall detection system with commodity WiFidevices,” IEEE Trans. Mobile Comput. vol. 16, no. 2, pp. 511–526, Feb.2017.[26] Y. Wang, K. Wu, and L. M. Ni, “Wifall: Device-free fall detection bywireless networks,” IEEE Trans. Mobile Comput. vol. 16, no. 2, pp.581–594, Feb. 2017.[27] Y. Wang, J. Liu, Y. Chen, M. Gruteser, J. Yang, and H. Liu, “E-eyes:Device-free location-oriented activity identiﬁcation using ﬁne-grainedwiﬁ signatures,” in Proc. ACM Mobicom’14 Maui, HI, Sept. 2014, pp.617–628.[28] W. Wang, A. Liu, M. Shahzad, K. Ling, and S. Lu, “Understanding andmodeling of WiFi signal based human activity recognition,” in Proc.ACM Mobicom’15 Paris, France, Sept. 2015, pp. 65–76.[29] X. Wang, C. Yang, and S. Mao, “PhaseBeat: Exploiting CSI phase datafor vital sign monitoring with commodity WiFi devices,” in Proc. IEEEICDCS 2017 Atlanta, GA, June 2017, pp. 1230–1239.[30] ——, “Tensorbeat: Tensor decomposition for monitoring multi-personbreathing beats with commodity WiFi,” ACM Transactions on IntelligentSystems and Technology vol. 9, no. 1, pp. 8:1–8:27, Sept. 2017.[31] W. Yang, X. Wang, A. Song, and S. Mao, “Wi-Wheat: Contact-freewheat moisture detection using commodity WiFi,” in Proc. IEEE ICC2018 Kansas City, MO, May 2018, pp. 1–6.[32] F. A. Gers, J. Schmidhuber, and F. Cummins, “Learning to forget:Continual prediction with LSTM,” Neural Computation vol. 12, no. 10,pp. 2451–2471, Oct. 1999.[33] K. Greff, R. K. Srivastava, J. Koutn ´ık, B. R. Steunebrink, and J. Schmid-huber, “LSTM: search space odyssey,” IEEE Transactions on NeuralNetworks and Learning Systems vol. 28, no. 10, pp. 2222–2232, 2017.[34] A. Graves, N. Jaitly, and A.-r. Mohamed, “Hybrid speech recognitionwith deep bidirectional lstm,” in Proc. 2013 IEEE Workshop on Auto-matic Speech Recognition and Understanding (ASRU) IEEE, 2013,pp. 273–278.[35] F. J. Ordonez and D. Roggen, “Deep convolutional and lstm recurrentneural networks for multimodal wearable activity recognition,” MDPISensors p. 115, Jan. 2016.[36] X. Wang, Z. Yu, and S. Mao, “DeepML: Deep LSTM for indoorlocalization with smartphone magnetic and light sensors,” in Proc. IEEEICC 2017 Kansas City, MO, May 2018.[37] X. Wang, S. Mao, and M. X. Gong, “A survey of lte wi-ﬁ coexistence inunlicensed bands,” GetMobile: Mobile Computing and Communications ,vol. 20, no. 3, pp. 17–23, 2017.[38] X. Wang, S. Mao, S. Pandey, and P. Agrawal, “CA2T: Cooperativeantenna arrays technique for pinpoint indoor localization,” in Proc.MobiSPC 2014 Niagara Falls, Canada: Elsevier, Aug. 2014, pp. 392–399.[39] Z. Yang, Z. Zhou, and Y. Liu, “From RSSI to CSI: Indoor localizationvia channel response,” ACM Comput. Sur. vol. 46, no. 2, p. 25, 2013.[40] X. Wang, C. Yang, and S. Mao, “ResBeat: Resilient breathing beatsmonitoring with online bimodal CSI data,” in Proc. IEEE GLOBECOM2017 Singapore, Dec. 2017.[41] C. Chen, Y. Han, Y. Chen, and K. R. Liu, “Indoor global positioningsystem with centimeter accuracy using wi-ﬁ [applications corner],” IEEESignal Processing Magazine vol. 33, no. 6, pp. 128–134, 2016.[42] D. Kingma and J. Ba, “Adam: method for stochastic optimization,”arXiv preprint arXiv:1412.6980 2014.[43] M. Abadi, A. Agarwal, P. Barham, E. Brevdo, Z. Chen, C. Citro, G. S.Corrado, A. Davis, J. Dean, M. Devin et al. “Tensorﬂow: Large-scalemachine learning on heterogeneous distributed systems,” arXiv preprintarXiv:1603.04467 2016.