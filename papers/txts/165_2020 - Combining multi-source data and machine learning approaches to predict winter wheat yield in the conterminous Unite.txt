remote sensing ArticleCombining Multi-Source Data and Machine LearningApproaches to Predict Winter Wheat Yield in theConterminous United StatesYumiao Wang1,2, Zhou Zhang1,*, Luwei Feng1,2, Qingyun Du2,3,4,5and Troy Runge11Biological Systems Engineering, University of Wisconsin–Madison, Madison, WI 53706, USA;wymfrank@whu.edu.cn (Y.W.); lwfeng@whu.edu.cn (L.F.); trunge@wisc.edu (T.R.)2School of Resources and Environmental Science, Wuhan University, Wuhan 430079, China;qydu@whu.edu.cn3Key Laboratory of GIS, Ministry of Education, Wuhan University, Wuhan 430079, China4Key Laboratory of Digital Mapping and Land Information Application Engineering, NationalAdministration of Surveying, Mapping and Geoinformation, Wuhan University, Wuhan 430079, China5Collaborative Innovation Center of Geospatial Technology, Wuhan University, Wuhan 430079, China*Correspondence: zzhang347@wisc.eduReceived: 23 February 2020; Accepted: 10 April 2020; Published: 12 April 2020/gid00030/gid00035/gid00032/gid00030/gid00038/gid00001/gid00033/gid00042/gid00045/gid00001/gid00048/gid00043/gid00031/gid00028/gid00047/gid00032/gid00046Abstract:Winter wheat (Triticum aestivumL.) is one of the most important cereal crops, supplyingessential food for the world population. Because the United States is major producer and exporter ofwheat to the world market, accurate and timely forecasting of wheat yield in the United States (U.S.)is fundamental to national crop management as well as global food security. Previous studies mainlyhave focused on developing empirical models using only satellite remote sensing images, while otheryield determinants have not yet been adequately explored. In addition, these models are based ontraditional statistical regression algorithms, while more advanced machine learning approaches havenot been explored. This study used advanced machine learning algorithms to establish within-seasonyield prediction models for winter wheat using multi-source data to address these issues. Speciﬁcally,yield driving factors were extracted from four di↵erent data sources, including satellite images,climate data, soil maps, and historical yield records. Subsequently, two linear regression methods,including ordinary least square (OLS) and least absolute shrinkage and selection operator (LASSO),and four well-known machine learning methods, including support vector machine (SVM), randomforest (RF), Adaptive Boosting (AdaBoost), and deep neural network (DNN), were applied andcompared for estimating the county-level winter wheat yield in the Conterminous United States(CONUS) within the growing season. Our models were trained on data from 2008 to 2016 andevaluated on data from 2017 and 2018, with the results demonstrating that the machine learningapproaches performed better than the linear regression models, with the best performance beingachieved using the AdaBoost model (R2=0.86, RMSE=0.51 t/ha, MAE=0.39 t/ha). Additionally,the results showed that combining data from multiple sources outperformed single source satellitedata, with the highest accuracy being obtained when the four data sources were all considered in themodel development. Finally, the prediction accuracy was also evaluated against timeliness withinthe growing season, with reliable predictions (R2>0.84) being able to be achieved 2.5 months beforethe harvest when the multi-source data were combined.Keywords:Winter wheat; yield prediction; machine learning; multi-source data; CONUSRemote Sens.2020,12, 1232; doi:10.3390/rs12081232www.mdpi.com/journal/remotesensingRemote Sens. 2020,12, 1232 of 211. IntroductionAs one of the top cereals that supply world food, wheat is rich source of calories and it is anessential staple in most regions of the world 1]. For example, in 2017, the global cereal crop productwas 2.98 billion tons, of which 780 million tons were wheat 2]. Despite the tremendous wheat productgrown annually, the total demand is still di cult to meet, leading to recent increase in food prices 3,4].The United States is one of the leading wheat producers in the world, with an annual production ofover 51 million tons in 2018 5]. Winter wheat Triticum aestivum L.), which is planted in the precedingfall, is primary variety, representing more than 70% of the total U.S. production 6]. Due to its largescale, timely and accurate forecasts of the winter wheat yield in the United States (U.S.) are of greatsigniﬁcance for regional and global food security.Satellite remote sensing provides non-destructive and cient way to monitor crop growth and,thus, has great potential for wheat yield analysis. In the last few decades, research has mainly focusedon establishing the relationship between vegetation indices (VIs) extracted from satellite images withthe reported yields 7–9]. The VIs data have been mainly obtained from Landsat and ModerateResolution Imaging Spectroradiometer (MODIS) 10]. Landsat data can provide ﬁner-scale spatialinformation, while MODIS data are more appropriate for studying large scale crop production due toits moderate spatial and high temporal resolution. The most commonly used VIs include NormalizedDi↵erence Vegetation Index (NDVI) and Enhanced Vegetation Index (EVI). For example, Ren et al.applied time series NDVI from MODIS to estimate winter wheat yield in Shandong, China 11].Similarly, Becker-Reshef et al. used daily NDVI from MODIS to estimate the winter wheat yield inKansas and Ukraine 12]. Kouadio et al. extracted multiple VIs to forecast wheat yield at the ecodistrictscale in Canada, and found that the prediction errors could be signiﬁcantly reduced using MODIS-EVIand NDVI 13].Although encouraging results have been achieved by using VIs, intrinsic yield driving factorshave not been yet been adequately explored in the model development. Very recently, researchers havestarted to assess wheat yield using data from more than one source 14–17]. For example, Saeed et al.combined weather data and NDVI to predict the wheat yield in Pakistan 18], and conﬁrmed thatthe best results were achieved when combining the two data sources. Cai et al. integrated satelliteand weather data to predict wheat yield in Australia, and demonstrated the unique contribution ofeach data source 19]. These studies provide insight into the potential impact of weather data onwheat production, while other yield determinants, such as soil properties, and prior information,such as historical yields, have not yet been considered. In addition, the most ↵ective combination ofmulti-source data still needs to be explored.Two types of approaches have been used for wheat yield prediction, including the crop simulationmodels and statistical models 20]. The crop models forecast yield by simulating the entire crop growth,when considering the physiological characteristics of plants and number of environmental factors,and representative wheat simulation models include CERES 21], ARCWHEAT1 22], DAISY 23],SIRIUS 24], and AFRCWHEAT2 model 25]. Although these models can have high predictive power,they typically require extensive input parameters that are related to crop variety and managementpractices, which are often di cult to obtain over large areas 26,27]. Moreover, the complexity ofphysiological processes brings further challenges for the model calibration 27].An alternative approach of simulating the physiological mechanism of the plant growth with cropmodels, statistical algorithms may be used to develop an empirical relationship between large numberof current season yield determinants along with historical yield records to develop future forecasts.Several linear regression approaches have been developed recently for wheat yield prediction 28–31].However, the main drawback of these linear models is that they often fail to reveal the complexrelationship between the input predictors and the yield, thus limiting their prediction performance andgeneralization to other areas 26,32]. New machine learning approaches that are capable of capturingthe nonlinear relationships between the yield and large set of predictors might ↵er an improvedmethod 33]. For example, Zhang et al. used the hyperspectral data and support vector machine (SVM)Remote Sens. 2020,12, 1232 of 21method to forecast the winter wheat yield in Hebei Province, China 34]. Safa et al. applied artiﬁcialneural networks (ANN) to predict the wheat production in Canterbury province, New Zealand 35].Besides using single approach, researchers have recently started to explore di ↵erent models in theirstudies. For instance, Wang et al. developed three models, including random forest (RF), SVM, andANN for estimating the biomass of winter wheat in China, and RF was found to be the best 36].Cai et al. used the same three models for predicting the winter wheat yield in Australia, and SVMachieved the best performance 19]. Since the model performance varies spatially, comprehensivecomparison between di ↵erent machine learning methods, including the deep learning model, needs tobe investigated for modeling the winter wheat yield in the Conterminous United States (CONUS).In this study, multi-source data, including satellite imagery, climate data, soil maps, and historicalyield records, were synergistically used as the predictors to forecast the winter wheat yield in theCONUS from 2008 to 2018 at the county level. Two linear regression methods (ordinary least square(OLS), least absolute shrinkage and selection operator (LASSO)) and four machine learning models(SVM, RF, and Adaptive Boosting (AdaBoost) and deep neural network (DNN)) were built andcompared. The goal of the study was to answer the following three questions: (1) Which is the bestmodel for predicting CONUS winter wheat yield? (2) How much improvement can be obtained bycombing the multi-source data? (3) What is the near real-time prediction performance within thegrowing season?2. Materials and Methods2.1. Data Acquisition and PreprocessingIn this study, four types of data were collected, including yield records, remote sensing images,climate data, and soil maps. Table 1shows complete summary, and the detailed descriptions for eachdata source and the extracted variables are discussed in the following sections, respectively.Table 1. detailed summary of the input data for yield modeling.Category Variable NameSpatialResolutionTemporalResolutionTimeCoverageSourceCrop dataYield (t /ha) County-level Yearly 2006–2018 USDA NASSCrop map 30 Yearly 2008–2018 USDA NASSVIsEVI500 Daily 2007–2018 MODISNDVINDWIGCIClimateLST_N (K)1 km 8-day 2007–2018 MODISLST_D (K)TDmean (C)4 km Daily 2007–2018 PRISMTmean (C)Tmx (C)Tmn (C)VPDmx (hPa)VPDmn (hPa)PPT (mm)SoilSOC (%)100 Static 2017Soil Properties andClass 100 GridsUnited StatesCC (%)SC (%)TN (%)BD (g cm3)PHRemote Sens. 2020,12, 1232 of 212.1.1. Wheat Yield DataThe goal of this study was to build machine learning models to forecast the county-level winterwheat yield in the CONUS. critical component is historical yield records required for the modeltraining, which we obtained from the United States Department of Agriculture (USDA) NASS QuickStats database 37]. For each county, the average yield over years 2008–2018 was calculated, as mappedin Figure 1. The primary production regions include the Great Plains, Paciﬁc Northwest, States alongthe Mississippi River and the eastern States. The ﬁgure also shows that the yields vary substantiallywith geographic location, with higher yields in the west (e.g. Idaho, Oregon, and California) and east(e.g. Indiana and Illinois) while lower yields in the central regions (e.g. Kansa, Oklahoma and Texas).Remote Sens. 2020, 12, FOR PEER REVIEW of 22 CC (%) Soil Properties and Class 100 Grids United States SC (%) TN (%) BD (g cm-3) PH 2.1.1. Wheat Yield Data The goal of this study was to build machine learning models to forecast the county-level winter wheat yield in the CONUS. critical component is historical yield records required for the model training, which we obtained from the United States Department of Agriculture (USDA) NASS Quick Stats database [37]. For each county, the average yield over years 2008–2018 was calculated, as mapped in Figure 1. The primary production regions include the Great Plains, Pacific Northwest, States along the Mississippi River and the eastern States. The figure also shows that the yields vary substantially with geographic location, with higher yields in the west (e.g. Idaho, Oregon, and California) and east (e.g. Indiana and Illinois) while lower yields in the central regions (e.g. Kansa, Oklahoma and Texas). For most counties in the CONUS, winter wheat is generally planted in the fall [38] and it becomes established in the period of late autumn and winter. It then goes into dormancy and requires process of vernalization until the following spring [39]. The plants recover in the spring and grow rapidly until the summer harvest. For modeling the winter wheat in the CONUS, uniform growing season is needed and, therefore, we defined it as from the preceding October to the end of July of the current year. We used the previous two years’ yields as one type of the model inputs since the historical yields were found to be useful for crop yield prediction [20]. Figure 1. The county-level average yield over years 2008–2018 of the winter wheat in the CONUS. 2.1.2. VI Data Since the effectiveness of VIs had been previously validated for yield prediction [40–42], they were also considered in this study and derived from MODIS data. Specifically, the cloud free 16-day averaged daily MODIS MCD43A3 product, which provides wealth of band information with 500-m spatial resolution, including the visible, near-infrared (NIR), and shortwave, was used for the VI extraction [43]. Four VIs that have been complementary and extensively used in crop yield analysis were calculated, including the NDVI, NDWI, EVI, and Green Chlorophyll Index (GCI). In particular, NDVI is widely used to assess vegetation vigor. NDWI is capable of extracting the moisture content of vegetation canopy. EVI is an optimized NDVI designed to improve the sensitivity of vegetation signals in areas with high biomass. GCI can indicate the canopy chlorophyll content and light use efficiency related to crop growth [44,45]. The four VIs were calculated while using equations (1–4). Figure 1. The county-level average yield over years 2008–2018 of the winter wheat in the CONUS.For most counties in the CONUS, winter wheat is generally planted in the fall 38] and it becomesestablished in the period of late autumn and winter. It then goes into dormancy and requires processof vernalization until the following spring 39]. The plants recover in the spring and grow rapidlyuntil the summer harvest. For modeling the winter wheat in the CONUS, uniform growing season isneeded and, therefore, we deﬁned it as from the preceding October to the end of July of the currentyear. We used the previous two years’ yields as one type of the model inputs since the historical yieldswere found to be useful for crop yield prediction 20].2.1.2. VI DataSince the ↵ectiveness of VIs had been previously validated for yield prediction 40–42], they werealso considered in this study and derived from MODIS data. Speciﬁcally, the cloud free 16-dayaveraged daily MODIS MCD43A3 product, which provides wealth of band information with 500-mspatial resolution, including the visible, near-infrared (NIR), and shortwave, was used for the VIextraction 43]. Four VIs that have been complementary and extensively used in crop yield analysiswere calculated, including the NDVI, NDWI, EVI, and Green Chlorophyll Index (GCI). In particular,NDVI is widely used to assess vegetation vigor. NDWI is capable of extracting the moisture content ofvegetation canopy. EVI is an optimized NDVI designed to improve the sensitivity of vegetation signalsin areas with high biomass. GCI can indicate the canopy chlorophyll content and light use ciencyrelated to crop growth 44,45]. The four VIs were calculated while using Equations (1)–(4).NDVI =NIR RedNIR+Red(1)NDWI =Green NIRGreen +NIR(2)EVI =G⇥(NIR Red)NIR+C1⇥RedC2⇥Blue+L(3)Remote Sens. 2020,12, 1232 of 21GCI=NIRGreen1 (4)where NIR, Red, Green, and Blue represent the reﬂectance of the near-infrared, red, green, and bluebands, respectively; is the canopy background adjustment; C1, C2 are the coe cients of the aerosolresistance term; and, is the gain factor. The coe cients of EVI in Equation (3) were chosen accordingto the MODIS EVI algorithm, with =1, C1 =6, C2 =7.5, and =2.5 [46].2.1.3. Climate DataIn addition to the widely adopted VIs, we also extracted the climate variables within the growingseason from two gridded data sources, including the Parameter-elevation Regressions on IndependentSlopes Model (PRISM) dataset 47] and MODIS Land Surface Temperature (LST) MOD11A2 product 48].The primary meteorological variables were derived based on the PRISM dataset with km spatialresolution. These variables include daily total precipitation (PPT), daily minimum and maximumvapor pressure deﬁcit (VPDmn, VPDmx), daily minimum, maximum, and mean temperature (Tmn,Tmx, Tmean), and daily mean dew point temperature (TDmean). Two additional variables, includingdaytime and nighttime land surface temperature (LST_D, LST_N), were extracted from the MOD11A2product, which is an eight-day composite data product with 1 km spatial resolution. In sum, theextracted factors can be divided into two categories: (1) water-related factors including PPT, VPDmn,and VPDmx, (2) temperature-related factors, including Tmean, Tmn, Tmx, TDmean, LST_D, andLST_N.2.1.4. Soil DataSoil properties, such as soil moisture and nutrient, also signiﬁcantly inﬂuence plant growth.In this study, six types of soil properties, including organic carbon content (SOC), total nitrogen(TN), bulk density (BD), pH, sand content (SC), and clay content (CC), were derived from theUS_SoilGrids100m soil maps 49]. The maps were generated to provide an estimation of soil propertiesfor the CONUS at seven di ↵erent depths (0, 5, 15, 30, 60, 100, and 200 cm) that are spatially continuousand internally consistent at 100-m spatial resolution. Each map describes one soil property at certaindepth. All of the maps are available and can be obtained from the Penn State University repository athttps: //scholarsphere.psu.edu [49]. We considered the six soil properties at all the seven depths sincethe winter wheat roots have shown to reach 200 cm depth 50].2.1.5. Data PreprocessingAll of the extracted yield ↵ecting factors, including the VIs, climate variables, and soil properties,were spatially aggregated to the county level, and the Cropland Data Layer (CDL) at 30-m resolutionprovided by NASS 51,52] was used to identify the wheat area and extract wheat ﬁelds. The dailysequential variables, including the climate data and VIs, were collected and aggregated to 16-dayinterval during the growing season, resulting in total of twenty temporal data records. The GoogleEarth Engine (GEE) platform 53] was used for these preprocessing steps. total of 304 input variableswere obtained for model development, including 260 for the sequential features (four VIs and nineclimate variables with twenty temporal records for each), 42 for the six soil properties from sevendepths, and two years of historical yields. We also showed the sample size for each year in Appendix AFigure A1, and “processed” samples in Figure A1were used for the model development. The sizedi↵erence among years is mainly due to two reasons. One is the long-term downward trend in winterwheat planting (Figure A1“raw” samples), which is likely due to the growing foreign competition ininternational wheat markets 6]. Additionally, in each year, the samples with missing values in theirfeatures were removed from the model development.Remote Sens. 2020,12, 1232 of 212.2. Model Development and Performance EvaluationThe extracted variables were ﬁrstly explored, with the signiﬁcant ones then applied for themodel development, to build accurate and timely yield prediction models. Di ↵erent machine learningmodels were then compared and evaluated. Next, the best model was selected for analyzing themulti-source data contribution and the near real-time prediction performance within the growingseason. Speciﬁcally, the entire workﬂow consists of the following ﬁve main steps: (1) select the mostinformative input variables using correlation analysis; (2) construct prediction models using twolinear regression (OLS and LASSO) and four machine learning methods (SVM, RF, AdaBoost, andDNN); (3) compare di ↵erent models in terms of the prediction accuracy and the spatial adaptability;(4) investigate the contribution of multiple data sources; and, (5) evaluate the forecasting performanceagainst timelines.2.2.1. Strategy for Input Variable SelectionWe ﬁrst applied the Pearson correlation coe cient (PCC) to select the variables that mostlya↵ect the yield to reduce the input data dimensionality. The PCC is common method to measurethe correlation degree between two variables, and an absolute value greater than 0.5 indicates goodcorrelation 54].Speciﬁcally, the PCCs were calculated between (1) each input variable and the yield and (2) anytwo variables within each data source. For the sequential VIs and climate data, the mean value of eachtime series variable was used for the calculation. Subsequently, two variables were selected from eachdata source based on the following criteria: (1) the variable that had the maximum absolute correlationwith the yield was selected; and, (2) among the remaining factors, the one had correlation with thepreviously selected variable below threshold (0.5 in this study), while most correlated with the yieldwas also included. This strategy can ensure selecting the informative and diverse factors, in order toimprove the ciency while reducing the redundancy in modeling.2.2.2. Machine Learning Algorithms for Yield PredictionWe explored two linear regression methods and four machine learning methods in this work.The dependent variable was the county-level winter wheat yield for the current year. The independentvariables were the selected variables and they were normalized before the model development.The models were trained on the data from 2008 to 2016 and then the trained models were evaluatedin 2017 and 2018. The scikit-learn library implemented six mainstream machine learning algorithmsin Python, and ﬁve-fold cross-validated grid search optimized their hyper-parameters using the“GridSearchCV” module in the library 55]. brief description of each algorithm is presented below.OLS is commonly used linear algorithm that aims to minimize the sum of the square errorsbetween the ground truth and the predicted value. However, OLS lacks penalties for the regressioncoecients and, thus, might cause overﬁtting when there is large number of input variables. LASSO,which was proposed by Tibshirani 56], is shrinkage and selection algorithm for linear regression toreduce overﬁtting. It assumes that some independent variables are more important than the others.Based on the OLS, L1 norm regularization was added to its loss function, which can not only reduceoverﬁtting, but also removes redundant information in the inputs. The main hyper-parameter of theLASSO is the weighting parameter of the regularization term, and it was set to 0.2 in this study.SVM is class of algorithm characterized by the usage of kernels and proposed by Gunn 57].There are two main steps in an SVM regression model. First, the variables are mapped from the originalspace to high-dimensional feature space by kernel function. The kernel function can be eitherlinear or non-linear, and it is determined by the relationship between the independent and dependentvariables. Second, linear model is constructed in the derived feature space to minimize the errors 58].The main hyper-parameters include kernel function, kernel coe cient, and regularizer weightingRemote Sens. 2020,12, 1232 of 21parameter, and they were assigned to “radial basis function (RBF)”, “0.1”, and “2”, respectively, inthis work.RF is an ensemble learning method that has been widely used in di ↵erent applications 59–61].It is constructed by large set of decision trees, with each tree being built using random set offeatures and samples. RF is bagging algorithm in which the decision trees are learned in parallel andindependent of each other, with the ﬁnal prediction combining the results from each individual tree.Two critical hyper-parameters include the total number of trees and the maximum depth of each tree,which were set to 400 and 8, respectively.AdaBoost is another ensemble learning method that was proposed by Freund and Schapire 62].When compared to RF, it is boosting algorithm in which the base learners are generated in asequential way, and the ﬁnal prediction is achieved by taking weighted average of base learners.In each iteration, the training samples are assigned di ↵erent weighting factors with more weight onmisclassiﬁed instances, which allows for the AdaBoost to control the bias and variance. In this work,the decision tree was used as the base learner. The parameters include the maximum number ofestimators, learning rate, and loss function were set to 400, 1, and “linear”, respectively.Deep learning is breakthrough technology in machine learning and data mining, which has astructure that provides su cient ability to learn feature representations from the data 63]. There aredi↵erent types of architectures, and our study applied the fully-connected DNN 64], which increasesthe depth of the conventional ANNs 65]. DNN contains one input layer, several hidden layers, and oneoutput layer. Each layer has collection of conceptualized neurons, which can move between layersthrough weighted connections and activation functions. In this study, we designed seven-layerednetwork, in which the number of neurons was set to 256, 128, 128, 64, and 24, respectively, in the ﬁvehidden layers. We used the “Relu” as the activation function and applied the “Dropout” strategy toimprove the model generalization ability. Finally, we conﬁgured the model with the “adam” optimizer,the “mean_absolute_error” loss function, and set the learning rate as 0.001.2.2.3. Metrics for Model EvaluationWe used the root mean squared error (RMSE), coe cient of determination (R2), and mean absoluteerror (MAE) to quantify the model prediction performance. Additionally, the spatial autocorrelationof prediction errors, which can be measured by the Global Moran’s metric, reﬂects the modelgeneralizability over the spatial domain, as demonstrated by previous studies 66–69]. The value ofGlobal Moran’s ranges from -1 to [ 70], where positive values indicate trend of aggregation andnegative values indicate trend of dispersion. Values that are near zero indicate spatial randomnesspatterns, with higher randomness indicating better model 71]. In this study, we used ArcGIS 10.6 tocalculate the Global Moran’s I.3. Results3.1. Important Factor Selection.The PCC was calculated within each data source, except for the historical yields as only twoprevious years’ yields were considered in this study, as demonstrated by previous studies. Additionally,it worth noting that the climate variables were divided into two categories, with the water- andtemperature-related variables in each. The correlation coe cients for each group are shown in Figure 2,and the corresponding p-values are shown in Appendix AFigure A2.Remote Sens. 2020,12, 1232 of 21Remote Sens. 2020, 12, FOR PEER REVIEW of 22 Figure 2. Correlation matrices for different data sources: (a) VIs; (b) Temperature-related factors; (c) Water-related factors; and, (d) Soil properties. Generally, the VIs all demonstrated positive correlations with the yield, while the temperature-related factors were negatively correlated with the yield. For the other two groups, both positive and negative correlations were observed. The method described in Section 2.2.1 was used to select important factors from each source. For example, within the VI group, NDWI and EVI were selected, because NDWI showed the strongest correlation with the yield; and, EVI had correlation less than 0.5 with the selected NDWI while showing the highest correlation with the yield among the remaining three factors. Similarly, we selected LST_D and Tmean among the Temperature-related factors; VPDmx and PPT from the Water-related factors; and, SOC and CC within the soil properties. 3.2. Model Comparison We trained the six models described in Section 2.2.2 using both the full and selected factors separately to compare the performances of different models and evaluate the effectiveness of the factor selection, and the accuracies on the testing data are reported in Table 2. First, the results showed that an RMSE of less than 0.7 t/ha, MAE of less than 0.6 t/ha, and an R2 of more than 0.75 were found for all of the approaches, demonstrating the efficacy of using multi-source data for yield prediction. Subsequently, when comparing the different methods, we found that the non-linear machine learning approaches, in general, performed better than the two linear approaches, and the AdaBoost model outperformed all other approaches, achieving an R2 of 0.85 while using the full factors, and an R2 of 0.86 with the reduced factors. Regarding the factor selection, improvements were observed in most cases, and the R2 was significantly increased for the DNN model when the reduced factors were considered. This was primarily because reducing the input factors could significantly reduce the number of weights that need to be estimated in the neural network and, thus, helped to prevent overfitting and enhanced the model generalization ability. Table 2. The predictive performance of the six models using both full and selected factors (the highest accuracy was highlighted in bold). Factors Model RMSE R2 MAE Full factors OLS 0.66 0.76 0.51 Figure 2. Correlation matrices for di ↵erent data sources: a) VIs; b) Temperature-related factors;(c) Water-related factors; and, d) Soil properties.Generally, the VIs all demonstrated positive correlations with the yield, while thetemperature-related factors were negatively correlated with the yield. For the other two groups, bothpositive and negative correlations were observed. The method described in Section 2.2.1 was used toselect important factors from each source. For example, within the VI group, NDWI and EVI wereselected, because NDWI showed the strongest correlation with the yield; and, EVI had correlationless than 0.5 with the selected NDWI while showing the highest correlation with the yield among theremaining three factors. Similarly, we selected LST_D and Tmean among the Temperature-relatedfactors; VPDmx and PPT from the Water-related factors; and, SOC and CC within the soil properties.3.2. Model ComparisonWe trained the six models described in Section 2.2.2 using both the full and selected factorsseparately to compare the performances of di ↵erent models and evaluate the ↵ectiveness of the factorselection, and the accuracies on the testing data are reported in Table 2. First, the results showed thatan RMSE of less than 0.7 /ha, MAE of less than 0.6 /ha, and an R2of more than 0.75 were foundfor all of the approaches, demonstrating the cacy of using multi-source data for yield prediction.Subsequently, when comparing the di ↵erent methods, we found that the non-linear machine learningapproaches, in general, performed better than the two linear approaches, and the AdaBoost modeloutperformed all other approaches, achieving an R2of 0.85 while using the full factors, and an R2of 0.86 with the reduced factors. Regarding the factor selection, improvements were observed inmost cases, and the R2was signiﬁcantly increased for the DNN model when the reduced factorswere considered. This was primarily because reducing the input factors could signiﬁcantly reducethe number of weights that need to be estimated in the neural network and, thus, helped to preventoverﬁtting and enhanced the model generalization ability.Remote Sens. 2020,12, 1232 of 21Table 2. The predictive performance of the six models using both full and selected factors (the highestaccuracy was highlighted in bold).Factors Model RMSE R2MAEFull factorsOLS 0.66 0.76 0.51LASSO 0.69 0.75 0.54SVM 0.61 0.80 0.48RF 0.59 0.81 0.46AdaBoost 0.52 0.85 0.41DNN 0.64 0.78 0.51Selected factorsOLS 0.68 0.75 0.54LASSO 0.57 0.81 0.45SVM 0.59 0.82 0.45RF 0.54 0.85 0.41AdaBoost 0.51 0.86 0.39DNN 0.62 0.83 0.49In addition, Figure 3further showed the agreement between the prediction and the reportedyield of di ↵erent models that were developed by the selected factors. The results were presented forboth the training (red) and testing datasets (black). Again, among the six statistical models, the bestagreement was found in the AdaBoost (Figure 3e), and the two linear methods showed less agreementthan the other approaches (Figure 3a,b). Besides, we also noticed that the yields were underestimatedin some high-yield counties (green ellipses), notably in the OLS, LASSO, and SVM models. This ismainly because the quantity of high-yield samples was relatively small, which results in di culty formodeling the yield variation. For the following analysis, we excluded the OLS model, as it consistentlyshowed the worst performance among all of the approaches.Remote Sens. 2020, 12, FOR PEER REVIEW of 22 LASSO 0.69 0.75 0.54 SVM 0.61 0.80 0.48 RF 0.59 0.81 0.46 AdaBoost 0.52 0.85 0.41 DNN 0.64 0.78 0.51 Selected factors OLS 0.68 0.75 0.54 LASSO 0.57 0.81 0.45 SVM 0.59 0.82 0.45 RF 0.54 0.85 0.41 AdaBoost 0.51 0.86 0.39 DNN 0.62 0.83 0.49 In addition, Figure further showed the agreement between the prediction and the reported yield of different models that were developed by the selected factors. The results were presented for both the training (red) and testing datasets (black). Again, among the six statistical models, the best agreement was found in the AdaBoost (Figure 3e), and the two linear methods showed less agreement than the other approaches (Figure a,b). Besides, we also noticed that the yields were underestimated in some high-yield counties (green ellipses), notably in the OLS, LASSO, and SVM models. This is mainly because the quantity of high-yield samples was relatively small, which results in difficulty for modeling the yield variation. For the following analysis, we excluded the OLS model, as it consistently showed the worst performance among all of the approaches. Figure 3. The scatter plots of the six models using the selected factors (the green ellipses represent the underestimated regions): (a) OLS; (b) LASSO; (濗): SVM; (d): RF; (e): AdaBoost; (f): DNN. 3.3. The Spatial patterns of predicted yield We further reported the predicted yields on the two testing years (2017 and 2018) in Figure 4, and the predictions were obtained by the five different models that were trained with the selected factors. In general, the spatial patterns of the predicted yield were consistent with the reality for all methods (Figure 4(c)–(j)), showing that high-yield counties were distributed in the west and east, while the yield in the central region was relatively low. Subsequently, when comparing the different approaches, we noticed that yields in the northeast region in the year of 2018 were underestimated in most models (black ellipses in Figure 4(d), (h), (j), and (l)), which were in agreement with the results Figure 3. The scatter plots of the six models using the selected factors (the green ellipses represent theunderestimated regions): a) OLS; b) LASSO; c): SVM; d): RF; e): AdaBoost; f): DNN.3.3. The Spatial Patterns of Predicted YieldWe further reported the predicted yields on the two testing years (2017 and 2018) in Figure 4,and the predictions were obtained by the ﬁve di ↵erent models that were trained with the selectedfactors. In general, the spatial patterns of the predicted yield were consistent with the reality forRemote Sens. 2020,12, 1232 10 of 21all methods (Figure 4c–j), showing that high-yield counties were distributed in the west and east,while the yield in the central region was relatively low. Subsequently, when comparing the di ↵erentapproaches, we noticed that yields in the northeast region in the year of 2018 were underestimatedin most models (black ellipses in Figure 4d,h,j,l), which were in agreement with the results shownin Figure 3, which was likely due to the reason of the small sample size of the high-yield counties.Additionally, it was seen that the predicted yield generated by the AdaBoost model (Figure 4e,f) hadthe most similar spatial patterns with the ground truth, while the linear LASSO model showed theworst, presenting both the underestimation in the northeast in 2018 (black ellipse in Figure 4l) and thesigniﬁcant overestimation in 2017 (red ellipse in Figure 4k).Remote Sens. 2020, 12, FOR PEER REVIEW 11 of 22 Figure 4. Cont.Remote Sens. 2020,12, 1232 11 of 21Remote Sens. 2020, 12, FOR PEER REVIEW 12 of 22 Figure 4. The spatial patterns of the prediction (the black ellipses represent the underestimated regions. The red ellipse represents the overestimated region)濁澳 Figure 4. The spatial patterns of the prediction (the black ellipses represent the underestimated regions.The red ellipse represents the overestimated region).We also calculated the relative prediction error of each model to evaluate the adaptability of themodels over the spatial domain, and the error maps are shown in Figure 5. For all of the approaches,the spatial clustering of overestimation (red ellipse) was observed in the central region in 2017, and theclustering of underestimation (black ellipse) was shown in west in 2018. The DNN, SVM, and LASSOhad additional aggregation of underestimation in the east region in 2018, and the LASSO modelshowed clustering of overestimation in the east in 2017 and in the central in 2018. We calculated theMoran’s for the prediction errors of the ﬁve models to further quantify the error patterns (Table 3).The Moran’s values of the models were all positive and the P-values were all less than 0.01, whichindicated the spatial dependent and clustering distribution of the prediction errors. Among all ofthe approaches, the AdaBoost model showed the weakest clustering with the lowest Moran’s valuein 2017 (Moran’s =0.36, <0.01) and 2018 (Moran’s =0.32, <0.01), demonstrating its strongerspatial adaptability in comparison with other approaches.Remote Sens. 2020,12, 1232 12 of 21Remote Sens. 2020, 12, FOR PEER REVIEW 13 of 22 Figure 5. The spatial patterns of the relative error (the black ellipses represent the spatial aggregation of underestimation. The red ellipses represent the spatial aggregation of overestimation). Figure 5. The spatial patterns of the relative error (the black ellipses represent the spatial aggregationof underestimation. The red ellipses represent the spatial aggregation of overestimation).Remote Sens. 2020,12, 1232 13 of 21Table 3. Moran’s of the prediction errors from di ↵erent models (MI: Moran’s I; P: P-value).AdaBoost RF DNN SVM LASSOMI MI MI MI MI P2017 0.36 0.00 0.37 0.00 0.44 0.00 0.38 0.00 0.41 0.002018 0.32 0.00 0.33 0.00 0.34 0.00 0.34 0.00 0.53 0.003.4. Multi-Source Data ContributionWe further compared the developed multi-source based full model with several other reducedmodels that were built by using fewer data sources to demonstrate the ↵ectiveness of using themulti-source data. In this analysis, the AdaBoost algorithm was considered due to its superiorperformance and only the selected factors from each data source were used for building the models.The prediction accuracies on the testing dataset, with di ↵erent data source combinations, are shown inFigure 6. From the results, it was evident that the best performance was obtained when all of the datasources were combined, with an R2of 0.86. Subsequently, within the single data source group, the bestperformance was achieved by using the soil data (R2=0.77), and the historical yields and sequentialVIs showed slightly better performance than the climate. This was probably because the soil data hadthe ﬁnest spatial resolution, providing precise input for modeling, while the others are associated withmore coarse resolutions, with km for several climate variables (Tmean, PPT, VPDmx). In addition tothe single source scenario, we also constructed two other reduced models while using the combinationof sequential (VI and Climate) and non-sequential (soil and historical yields) factors. In both cases,the results outperformed the predictions that were obtained from the corresponding single data source,and an R2of 0.8 was achieved when the soil and historical yields were combined. However, the timeseries factors were not able to explain more yield variation than the other case, which might also bedue to the coarse spatial resolution of these variables.Remote Sens. 2020, 12, FOR PEER REVIEW 14 of 22 Table 3. Moran's of the prediction errors from different models (MI: Moran's I; P: P-value). 澳澳 d B o t F N S M A S MI MI MI MI MI 2017 0.36 0.00 0.37 0.00 . 4 0.00 0.38 0.00 . 1 0.00 2018 0.32 0.00 0.33 0.00 0.34 0.00 0.34 0.00 0.53 0.00 3.4. Multi-Source Data Contribution We further compared the developed multi-source based full model with several other reduced models that were built by using fewer data sources to demonstrate the effectiveness of using the multi-source data. In this analysis, the AdaBoost algorithm was considered due to its superior performance and only the selected factors from each data source were used for building the models. The prediction accuracies on the testing dataset, with different data source combinations, are shown in Figure 6. From the results, it was evident that the best performance was obtained when all of the data sources were combined, with an R2 of 0.86. Subsequently, within the single data source group, the best performance was achieved by using the soil data (R2 0.77), and the historical yields and sequential VIs showed slightly better performance than the climate. This was probably because the soil data had the finest spatial resolution, providing precise input for modeling, while the others are associated with more coarse resolutions, with k f r e e a c i a e a i b e ( m a , P , VPDmx). In addition to the single source scenario, we also constructed two other reduced models while using the combination of sequential (VI and Climate) and non-sequential (soil and historical yields) factors. In both cases, the results outperformed the predictions that were obtained from the corresponding single data source, and an R2 of 0.8 was achieved when the soil and historical yields were combined. However, the time series factors were not able to explain more yield variation than the other case, which might also be due to the coarse spatial resolution of these variables. Figure 6. The performance of the AdaBoost model using different combinations of the multi-source data. 3.5. Time-Series Prediction Performance We then further investigate the model forecasting performance against timelines to achieve real-time yield prediction. Within the growing season, we compared the multi-source based full model with the reduced model only trained on the sequential data over time, and again, the AdaBoost algorithm was applied in all cases. The results were separately reported on the two testing years in Figure 7. When only considering the sequential data, the model accuracy significantly increased as time proceeds, and the best performance was achieved until harvest (July). Within the entire growing season, noticeable accuracy improvement was observed between December and the following Figure 6. The performance of the AdaBoost model using di ↵erent combinations of the multi-source data.3.5. Time-Series Prediction PerformanceWe then further investigate the model forecasting performance against timelines to achievereal-time yield prediction. Within the growing season, we compared the multi-source based fullmodel with the reduced model only trained on the sequential data over time, and again, the AdaBoostalgorithm was applied in all cases. The results were separately reported on the two testing years inFigure 7.Remote Sens. 2020,12, 1232 14 of 21Remote Sens. 2020, 12, FOR PEER REVIEW 15 of 22 January, during which period the wheat starts the vernalization process, and then transits from vegetative growth to reproductive growth. During this period, the meterological conditions are essential for developing the wheat head size and, thus, play an important role in modeling the yield [72,73]. In addition, we also divided the entire growth period into three sub-seasons, including (1) Early season: from preceding October to December; (2) Middle season: from January to April; and, (3) Late season: from May to July, and the prediction results (Appendix Table A1) also demonstrated that each phenological stage has certain impact on the end-of-season yield and, thus, lacking the information from any stage would negatively affect the model performance. In contrast, the full model showed different patterns. It outperformed the sequential model and showed robust performance within the entire growing season. This was largely because complementary information provided by the multi-source data can contribute to more stable model. For example, the historical yields and soil properties, which were included in the full model, can provide prior knowledge for the yield potential, leading to better performance in early-season prediction. In addition, although stable, noticeable improvements were still observed from mid-April to mid-May, during which the plants go through the heading, flowering, and early grain-filling stages. The model prediction capacity might be strengthened by the stronger correlation between the VIs with the yield during the flowering and grain-filling stages, as previously demonstrated [74,75]. Moreover, winter wheat is highly sensitive to the environmental stress during this stage [76,77], and climatic variables would significantly contribute to yield modeling within this period. These comparison results showed that the full model developed based on the multi-source data is more robust over time, and high-performance prediction could be achieved in the middle of May, which is two and half months before harvesting. Figure 7. The time-series performance of the AdaBoost model (Seq: using sequential data; Full: using all data). 4. Discussion 4.1. Performance of Machine Learning Models This study aimed to combine machine learning methods and multi-source data to predict the winter wheat yield in the CONUS. We used both the full and selected factors from the multi-source data to develop two linear and four machine learning models for yield prediction. The results indicated that factor selection played an important role in improving model performance, which was in agreement with previous studies [19,60]. We noticed that the OLS method had lower accuracy than all of the other methods and its performance cannot be improved through factor selection. This is because OLS is basic linear method, and it is unable to process high dimensional data. Although 0.30.40.50.60.70.80.9Oct Nov Dec Jan Feb Mar Apr May Jun JulR2Time2018_Seq2018_Full2017_Seq2017_FullFigure 7. The time-series performance of the AdaBoost model (Seq: using sequential data; Full: usingall data).When only considering the sequential data, the model accuracy signiﬁcantly increased as timeproceeds, and the best performance was achieved until harvest (July). Within the entire growing season,a noticeable accuracy improvement was observed between December and the following January, duringwhich period the wheat starts the vernalization process, and then transits from vegetative growth toreproductive growth. During this period, the meterological conditions are essential for developing thewheat head size and, thus, play an important role in modeling the yield 72,73]. In addition, we alsodivided the entire growth period into three sub-seasons, including (1) Early season: from precedingOctober to December; (2) Middle season: from January to April; and, (3) Late season: from May to July,and the prediction results (Appendix ATable A1) also demonstrated that each phenological stage hasa certain impact on the end-of-season yield and, thus, lacking the information from any stage wouldnegatively ↵ect the model performance.In contrast, the full model showed di ↵erent patterns. It outperformed the sequential model andshowed robust performance within the entire growing season. This was largely because complementaryinformation provided by the multi-source data can contribute to more stable model. For example,the historical yields and soil properties, which were included in the full model, can provide priorknowledge for the yield potential, leading to better performance in early-season prediction. In addition,although stable, noticeable improvements were still observed from mid-April to mid-May, duringwhich the plants go through the heading, ﬂowering, and early grain-ﬁlling stages. The model predictioncapacity might be strengthened by the stronger correlation between the VIs with the yield during theﬂowering and grain-ﬁlling stages, as previously demonstrated 74,75]. Moreover, winter wheat ishighly sensitive to the environmental stress during this stage 76,77], and climatic variables wouldsigniﬁcantly contribute to yield modeling within this period. These comparison results showed that thefull model developed based on the multi-source data is more robust over time, and high-performanceprediction could be achieved in the middle of May, which is two and half months before harvesting.4. Discussion4.1. Performance of Machine Learning ModelsThis study aimed to combine machine learning methods and multi-source data to predict thewinter wheat yield in the CONUS. We used both the full and selected factors from the multi-source datato develop two linear and four machine learning models for yield prediction. The results indicated thatfactor selection played an important role in improving model performance, which was in agreementwith previous studies 19,60]. We noticed that the OLS method had lower accuracy than all of the otherRemote Sens. 2020,12, 1232 15 of 21methods and its performance cannot be improved through factor selection. This is because OLS is abasic linear method, and it is unable to process high dimensional data. Although LASSO is also linearapproach, it is constructed with weight constraint process, thus resulting in better performancewhen dealing with large number of input variables.The results also demonstrated that the machine learning methods were superior to the twolinear methods, which was consistent with the previous studies demonstrating that machine learningmethods are good at handling nonlinear and complex datasets 78,79]. Among the four machinelearning models, the AdaBoost method achieved the highest accuracy in this study. DNN was inferiorto the two ensemble learning methods (RF and AdaBoost) in this work, although it often outperformstraditional machine learning methods under larger sample size 80,81]. This is mainly because thesample set, including the winter wheat growing-counties over 11 years (2008–2018) in the CONUS,was still relatively small for training the DNN model. RF outperformed the other models, exceptAdaBoost. This is probably because combining multiple base learners into one predictive model canhelp to decrease the variance 82]. In this study, the AdaBoost method performed better than RF, whichwas probably attributable to the boosting strategy, which pays more attention to the prediction errorand generates new tree to minimize that error.4.2. Spatial Adaptability of Model PerformanceThe study found that, in some high-yield regions, the yields were underestimated in severalmodels (Figure 3), which was in agreement with the previous studies 12,67,83]. This may be dueto the small quantity of samples with high-yield or due to the fact that higher yield was typicallyassociated with higher density, which might cause saturation issue of optical remote sensing andthus ↵ect the model performance. We also compared the spatial adaptability of di ↵erent modelsusing Global Morans’I, which showed that the prediction errors from all the models had some spatialaggregation, indicating that their performances vary over space. Our study predicted yield for theentire CONUS, and understandably such large spatial scale typically introduces more complexenvironmental conditions and greater variability in planting conditions, which can also lead to unstablemodeling performance in the spatial domain 84,85]. It is noteworthy that the spatial aggregation of theLASSO model was higher than the other machine learning methods, which indicated that this linearmethod was unable to model the complex spatial data 86,87]. Meanwhile, AdaBoost model exhibitedthe best performance in addressing the spatial variation with the lowest Moran’s value, indicatingthat the boosting strategy not only improves overall accuracy, but also improves spatial adaptability.4.3. Impact of Multi-Source Data on Yield PredictionWe ﬁrst used the PCC method to analyze the correlation between the yield and the variablesfrom multi-source data. The results showed that all of the VI factors were positively correlated withthe yield, while the temperature-related factors showed negative correlations with the yield, whichwere consistent with the previous study 19]. This method allowed for us to ﬁnd the important yielda↵ecting factors, including the NDWI and EVI from the VIs; LSD_T, Tmean, VPDmx, and PPT fromthe climate variables; SOC and CC from the soil properties, and the previous two years of yields.With the selected factors from multi-source data, the AdaBoost model achieved the highest accuracy inthis study.We evaluated the contribution of di ↵erent data sources in yield modeling. For the single datasource, the soil factors could achieve better performance than other data sources. Soil propertiesrepresent the fertility of soil, which directly ↵ects the crop yield. Majchrzak et al. established amultiple regression to estimate the wheat yield while using 16 soil properties in Illinois, and theﬁnal model explained 78% variation in the wheat yield (R2=0.78) 88]. Our soil variables thatwere extracted at seven di ↵erent depths provided more detailed information, leading to enhancedprediction performance. 89]. We also noticed that the combinations of multiple sources, in general,outperformed the single data source, with the full data sources achieving the best performance.Remote Sens. 2020,12, 1232 16 of 21However, when combining the VI and climate data, it underperformed the models using only the soilfactors. One possible reason is that the resolutions of the VIs (500 m) and climate variables (4 km) weremuch lower than the soil maps (100 m), and such coarse resolution might fail to capture the variationwithin the target unit 19]. Finally, we found that multi-source data also played an important role intime-series prediction. As compared only using the sequential data (VIs and climate variables), the fullmodel with multi-source data maintained stable accuracy over the growing season, but it also achievedgood performance two and half months before the harvest.4.4. Uncertainties and Future WorkLike all models, there are some limitations to the current study and modeling methods. First,the spatial resolution of the remote sensing data used in this work was relatively coarse and maya↵ect the accuracy of the yield prediction. For further studies, we would consider data with higherresolution, such as Landsat and Sentinel. Second, spatial autocorrelation was not considered in thismodeling, and it was necessary to incorporate spatial analysis into the machine learning approaches inorder to reduce the spatial clustering issue. Third, although this approach worked well in the CONUS,it would be necessary to test its adaptability for other crops and regions.5. ConclusionsBecause of the signiﬁcant role of winter wheat in the U.S., it is essential to estimate its yieldprecisely and timely. For this purpose, we developed machine learning models to predict county-levelwinter wheat yield for the CONUS, by using multi-source data. The results indicated that machinelearning methods outperformed statistical methods, and the AdaBoost method performed the best.In addition, we examined the spatial autocorrelation of prediction errors for di ↵erent models and, again,the Adaboost model showed the least clustering pattern, indicating its stronger spatial adaptability incomparison with other approaches. Furthermore, we explored the contribution of di ↵erent data sources,and demonstrated the cacy of using the multi-source data. We also found that soil properties aremore critical than other data sources. Finally, we evaluated the model performance in simulatedreal-time manner, with the results indicating that reliable prediction could be achieved two and ahalf months before harvest.Author Contributions: Conceptualization, Y.W. and Z.Z.; Formal analysis, Y.W., Z.Z. and L.F.; Methodology, Y.W.and Z.Z.; Validation, Y.W.; Writing—original draft, Y.W. and Z.Z.; Writing—review editing, Y.W., Z.Z., L.F., Q.D.and T.R. All authors have read and agreed to the published version of the manuscript.Funding: Support for this research was provided by the USDA National Institute of Food and Agriculture, UnitedStates Department of Agriculture, Hatch project WIS03026; the University of Wisconsin–Madison, ce of the ViceChancellor for Research and Graduate Education with funding from the Wisconsin Alumni Research Foundation;the China Scholarship Council (NO.201906270090); and the Wuhan University Graduates International ExchangeProgram (NO.201909).Acknowledgments: The authors would like to thank the valuable comments and suggestions of theanonymous reviewers.Conﬂicts of Interest: The authors declare no conﬂict of interest.Remote Sens. 2020,12, 1232 17 of 21Appendix ARemote Sens. 2020, 12, FOR PEER REVIEW 18 of 22 Figure A1. The sample size of each year from 2008–2018 (“raw”: samples with yield records from USDA NASS; “processed”: samples with complete input variables). Figure A2. P-values for different data sources: (a) VIs; b T m e a u e r l t d a t r ; c W t r -related factors; (d) Soil properties. Table A1. Model performance comparison using different sub-season combinations (“ES”: early season; “MS”: middle season; “LS”: late season). ES MS ES MS LS MS LS ES MS LS VI 0.468 0.492 0.587 0.709 0.714 0.727 Climate 0.312 0.486 0.578 0.607 0.671 0.692 VI Climate 0.496 0.644 0.678 0.742 0.756 0.760 References 1. FAO. World Food and Agriculture Statistical Pocketbook; FAO: Rome, Italy, 2019. 2. FAO. FAOSTAT. Available online: http://www.fao.org/faostat/zh/#data/QC (accessed on December 2019). 3. Lesk, C.; Rowhani, P.; Ramankutty, N. Influence of extreme weather disasters on global crop production. Nature 2016, 529, 84–87, doi:10.1038/nature16467. 4. Franch, B.; Vermote, E.F.; Becker–Reshef, I.; Claverie, M.; Huang, J.; Zhang, J.; Justice, C.; Sobrino, J.A. Improving the timeliness of winter wheat production forecast in the United States of America, Ukraine and 02004006008001000120014002008 2009 2010 2011 2012 2013 2014 2015 2016 2017 2018rawprocessedFigure A1. The sample size of each year from 2008–2018 (“raw”: samples with yield records fromUSDA NASS; “processed”: samples with complete input variables).Remote Sens. 2020, 12, FOR PEER REVIEW 18 of 22 Figure A1. The sample size of each year from 2008–2018 (“raw”: samples with yield records from USDA NASS; “processed”: samples with complete input variables). Figure A2. P-values for different data sources: (a) VIs; b T m e a u e r l t d a t r ; c W t r -related factors; (d) Soil properties. Table A1. Model performance comparison using different sub-season combinations (“ES”: early season; “MS”: middle season; “LS”: late season). ES MS ES MS LS MS LS ES MS LS VI 0.468 0.492 0.587 0.709 0.714 0.727 Climate 0.312 0.486 0.578 0.607 0.671 0.692 VI Climate 0.496 0.644 0.678 0.742 0.756 0.760 References 1. FAO. World Food and Agriculture Statistical Pocketbook; FAO: Rome, Italy, 2019. 2. FAO. FAOSTAT. Available online: http://www.fao.org/faostat/zh/#data/QC (accessed on December 2019). 3. Lesk, C.; Rowhani, P.; Ramankutty, N. Influence of extreme weather disasters on global crop production. Nature 2016, 529, 84–87, doi:10.1038/nature16467. 4. Franch, B.; Vermote, E.F.; Becker–Reshef, I.; Claverie, M.; Huang, J.; Zhang, J.; Justice, C.; Sobrino, J.A. Improving the timeliness of winter wheat production forecast in the United States of America, Ukraine and 02004006008001000120014002008 2009 2010 2011 2012 2013 2014 2015 2016 2017 2018rawprocessedFigure A2. P-values for di ↵erent data sources: a) VIs; b) Temperature-related factors; c) Water-relatedfactors; d) Soil properties.Table A1. Model performance comparison using di ↵erent sub-season combinations (“ES”: early season;“MS”: middle season; “LS”: late season).ES MS ES +MS LS MS +LS ES +MS+LSVI 0.468 0.492 0.587 0.709 0.714 0.727Climate 0.312 0.486 0.578 0.607 0.671 0.692VI+Climate 0.496 0.644 0.678 0.742 0.756 0.760References1. FAO. World Food and Agriculture Statistical Pocketbook FAO: Rome, Italy, 2019.2. FAO. FAOSTAT. Available online: http: //www.fao.org /faostat /zh/#data /QC(accessed on December 2019).3. Lesk, C.; Rowhani, P.; Ramankutty, N. Inﬂuence of extreme weather disasters on global crop production.Nature 2016,529, 84–87. CrossRef ][PubMed ]Remote Sens. 2020,12, 1232 18 of 214. Franch, B.; Vermote, E.F.; Becker–Reshef, I.; Claverie, M.; Huang, J.; Zhang, J.; Justice, C.; Sobrino, J.A.Improving the timeliness of winter wheat production forecast in the United States of America, Ukraine andChina using MODIS data and NCAR Growing Degree Day information. Remote Sens. Environ. 2015,161,131–148. CrossRef ]5. Statista. U.S. Imports and Exports of Wheat from 2000 /01 to 2018 /19 (in Million Metric Tons). Availableonline: https: //www.statista.com /statistics /237902 /us--wheat--imports--and--exports--since--2000 /(accessedon December 2019).6. USDA. Wheat Sector at Glance. Available online: https: //www.ers.usda.gov /topics /crops /cotton-wool /cotton-sector-at-a-glance /(accessed on December 2019).7. Rembold, F.; Atzberger, C.; Savin, I.; Rojas, O. Using low resolution satellite imagery for yield prediction andyield anomaly detection. Remote Sens. 2013,5, 1704–1733. CrossRef ]8. Sibley, A.M.; Grassini, P.; Thomas, N.E.; Cassman, K.G. Testing remote sensing approaches for assessingyield variability among maize ﬁelds. Agron. J. 2014,106, 24–32. CrossRef ]9. Guan, K.Y.; Wu, J.; Kimball, J.S.; Anderson, M.C.; Frolking, S.; Li, B.; Hain, C.R.; Lobe, D.B. The shared andunique values of optical, ﬂuorescence, thermal and microwave satellite data for estimating large–scale cropyields. Remote Sens. Environ. 2017,199, 333–349. CrossRef ]10. Kayad, A.G.; Al-Gaadi, K.A.; Tola, E.; Madugundu, R.; Zeyada, A.M.; Kalaitzidis, C. Assessing the spatialvariability of alfalfa yield using satellite imagery and ground–based data. PLoS ONE 2016,11.[CrossRef ]11. Ren, J.; Chen, Z.; Zhou, Q.; Tang, H. Regional yield estimation for winter wheat with MODIS–NDVI data inShandong, China. Int. J. Appl. Earth Obs. Geoinf. 2008,10, 403–413. CrossRef ]12. Becker–Reshef, I.; Vermote, E.; Lindeman, M.; Justice, C. generalized regression–based model for forecastingwinter wheat yields in Kansas and Ukraine using MODIS data. Remote Sens. Environ. 2010,114, 1312–1323.[CrossRef ]13. Kouadio, L.; Newlands, K.N.; Davidson, A.; Zhang, Y.; Chipanshi, A. Assessing the Performance of MODISNDVI and EVI for Seasonal Crop Yield Forecasting at the Ecodistrict Scale. Remote Sens. 2014,6, 10193–10214.[CrossRef ]14. Holzman, M.E.; Rivas, R.; Piccolo, M.C. Estimating soil moisture and the relationship with crop yield usingsurface temperature and vegetation index. Int. J. Appl. Earth Obs. Geoinf. 2014,28, 181–192. CrossRef ]15. Balaghi, R.; Tychon, B.; Eerens, H.; Jlibene, M. Empirical regression models using NDVI, rainfall andtemperature data for the early prediction of wheat grain yields in Morocco. Int. J. Appl. Earth Obs. Geoinf.2008,10, 438–452. CrossRef ]16. Newlands, N.K.; Zamar, D.S.; Kouadio, L.A.; Zhang, Y.; Chipanshi, A.; Potgieter, A.; Toure, S.; Hill, H.S.J.An integrated, probabilistic model for improved seasonal forecasting of agricultural crop yield underenvironmental uncertainty. Front. Environ. Sci. 2014,2, 17. CrossRef ]17. Ma, Y.; Kang, Y.; Ozdogan, M.; Zhang, Z. County–Level Corn Yield Prediction Using Deep Transfer Learning.In Proceedings of the AGU Fall Meeting 2019, San Francisco, CA, USA, 9–13 December 2019.18. Saeed, U.; Dempewolf, J.; Becker–Reshef, I.; Khan, A.; Ahmad, A.; Wajid, S.A. Forecasting wheat yield fromweather data and MODIS NDVI using Random Forests for Punjab province, Pakistan. Int. J. Remote Sens.2017,38, 4831–4854. CrossRef ]19. Cai, Y.; Guan, K.; Lobell, D.; Potgieter, A.B.; Wang, S.; Peng, J.; Xu, T.; Asseng, S.; Zhang, Y.; You, L.; et al.Integrating satellite and climate data to predict wheat yield in Australia using machine learning approaches.Agric. For. Meteorol. 2019,274, 144–159. CrossRef ]20. Zhang, Z.; Jin, Y.; Chen, B.; Brown, P. California Almond Yield Prediction at the Orchard Level With aMachine Learning Approach. Front. Plant Sci. 2019,10, 809. CrossRef ][PubMed ]21. Ritchie, J.T.O. Description and performance of CERES wheat: user—Oriented wheat yield model.ARS Wheat Yield Proj. 1985, 159–175.22. Jamieson, P.D.; Porter, J.R.; Wilson, D.R. test of the computer simulation model ARCWHEAT1 on wheatcrops grown in New Zealand. Field Crop. Res. 1991,27, 337–350. CrossRef ]23. Hansen, S.; Jensen, H.E.; Nielsen, N.E.; Svendsen, H. Simulation of nitrogen dynamics and biomass productionin winter wheat using the Danish simulation model DAISY. Fertil. Res. 1991,27, 245–259. CrossRef ]24. Jamieson, P.D.; Semenov, M.A.; Brooking, I.R.; Francis, G.S. Sirius: mechanistic model of wheat responseto environmental variation. Eur. J. Agron. 1998,8, 161–179. CrossRef ]Remote Sens. 2020,12, 1232 19 of 2125. Porter, J.R. AFRCWHEAT2: model of the growth and development of wheat incorporating responses towater and nitrogen. Eur. J. Agron. 1993,2, 69–82. CrossRef ]26. Moriondo, M.; Maselli, F.; Bindi, M. simple model of regional wheat yield based on NDVI data. Eur. J.Agron. 2007,26, 266–274. CrossRef ]27. Lobell, D.B.; Burke, M.B. On the use of statistical models to predict crop yield responses to climate change.Agric. For. Meteorol. 2010,150, 1443–1452. CrossRef ]28. Wall, L.; Larocque, D.; éger, P.M. The early explanatory power of NDVI in crop yield modelling. Int. J.Remote Sens. 2008,29, 2211–2225. CrossRef ]29. Dubey, R.P.; Ajwani, N.; Kalubarme, M.H.; Sridhar, V.N.; Navalgund, R.R.; Mahey, R.K.; Sidhu, S.S.;Jhorar, O.P.; Cheema, S.S.; Na Rang, R.S. Pre–harvest wheat yield and production estimation for the Punjab,India. Int. J. Remote Sens. 1994,15, 2137–2144. CrossRef ]30. Sridhar, V.N.; Dadhwal, V.K.; Chaudhari, K.N.; Sharma, R.; Bairagi, G.D.; Sharma, A.K. Wheat productionforecasting for predominantly unirrigated region in Madhya Pradesh. Titleremote Sens. 1994,15, 1307–1316.[CrossRef ]31. Forecasting, Y. Analysis of GAC NDVI data for cropland identiﬁcation and yield forecasting in MediterraneanAfrican countries. Photogramm. Eng. Remote Sens. 2001,67, 593–602.32. Doraiswamy, P.C.; Moulin, S.; Cook, P.W.; Stern, A. Crop yield assessment from remote sensing. Photogramm.Eng. Remote Sens. 2003,69, 665–674. CrossRef ]33. Heremans, S.; Dong, Q.; Zhang, B.; Bydekerke, L.; Van Orshoven, J. Potential of ensemble tree methodsfor early–season prediction of winter wheat yield from short time series of remotely sensed normalizeddi↵erence vegetation index and in situ meteorological data. J. Appl. Remote Sens. 2015, 9. [CrossRef ]34. Zhang, Y.; Qin, Q.; Ren, H.; Sun, Y.; Li, M.; Zhang, T.; Ren, S. Optimal Hyperspectral CharacteristicsDetermination for Winter Wheat Yield Prediction. Remote Sens. 2018,10, 2015. CrossRef ]35. Safa, M.; Samarasinghe, S.; Nejat, M. Prediction of wheat production using artiﬁcial neural networks andinvestigating indirect factors ↵ecting it: Case study in Canterbury province, New Zealand. J. Agric. Sci.Technol. 2015,17, 791–803.36. Wang, L.A.; Zhou, X.; Zhu, X.; Dong, Z.; Guo, W. Estimation of biomass in wheat using random forestregression algorithm and remote sensing data. Crop J. 2016,4, 212–219. CrossRef ]37. NASS. NASS Quick Stats. In USDA National Agricultural Statistics Service (NASS). Available online:http: //quickstats.nass.usda.gov /(accessed on December 2019).38. USDA–NASS. Field Crops: Usual Planting and Harvesting Dates. In USDA National Agricultural StatisticsService, Agriculural Handbook NASS: Burr Ridge, IL, USA, 2010.39. Miller, T.D. Growth Stages of Wheat: Identiﬁcation and Understanding Improve Crop Management. BetterCrops 1992,76, 12–17.40. Son, N.T.; Chen, C.F.; Chen, C.R.; Minh, V.Q.; Trung, N.H. comparative analysis of multitemporal MODISEVI and NDVI data for large–scale rice yield estimation. Agric. For. Meteorol. 2014,197, 52–64. CrossRef ]41. Bolton, D.K.; Friedl, M.A. Forecasting crop yield using remotely sensed vegetation indices and crop phenologymetrics. Agric. For. Meteorol. 2013,173, 74–84. CrossRef ]42. Peng, Y.; Gitelson, A.A. Application of chlorophyll–related vegetation indices for remote estimation of maizeproductivity. Agric. For. Meteorol. 2011,151, 1267–1276. CrossRef ]43. Schaaf, C.; Wang, Z. MCD43A3 MODIS /Terra +Aqua BRDF /Albedo Daily L3 Global—500 V006 NASA:Washington, DC, USA, 2015.44. Gitelson, A.A.; Vina, A.; Ciganda, V.; Rundquist, D.C.; Arkebauer, T.J. Remote estimation of canopychlorophyll content in crops. Geophys. Res. Lett. 2005, 32. CrossRef ]45. Wu, C.; Niu, Z.; Gao, S. The potential of the satellite derived green chlorophyll index for estimating middaylight use ciency in maize, coniferous forest and grassland. Ecol. Indic. 2012,14, 66–73. CrossRef ]46. Jiang, Z.; Huete, A.; Didan, K.; Miura, T. Development of two–band enhanced vegetation index without ablue band. Remote Sens. Environ. 2008,112, 3833–3845. CrossRef ]47. PRISM. Climate Group Oregon State University: Corvallis, OR, USA, 2019.48. Wan, Z.; Hook, S.; Hulley, G. MOD11A2 MODIS /Terra Land Surface Temperature /Emissivity 8–day L3 Global kmSIN Grid V006 LP DAAC: Sioux Falls, SD, USA, 2015.Remote Sens. 2020,12, 1232 20 of 2149. Ramcharan, A.; Hengl, T.; Nauman, T.; Brungard, C.; Waltman, S.; Wills, S.; Thompson, J. Soil Property andClass Maps of the Conterminous United States at 100–Meter Spatial Resolution. Soil Sci. Soc. Am. J. 2018, 82.[CrossRef ]50. Thorup–Kristensen, K.; Salmer ón Cortasa, M.; Loges, R. Winter wheat roots grow twice as deep as springwheat roots, is this important for uptake and leaching losses? Plant Soil 2009,322, 101–114. CrossRef ]51. USDA–NASS. USDA National Agricultural Statistics Service Cropland Data Layer. Available online:https: //nassgeodata.gmu.edu /CropScape /(accessed on December 2019).52. Boryan, C.; Yang, Z.; Mueller, R.; Craig, M. Monitoring US agriculture: The US department of agriculture,national agricultural statistics service, cropland data layer program. Geocarto Int. 2011,26, 341–358. CrossRef ]53. Gorelick, N.; Hancher, M.; Dixon, M.; Ilyushchenko, S.; Thau, D.; Moore, R. Google Earth Engine:Planetary–scale geospatial analysis for everyone. Remote Sens. Environ. 2017,202, 18–27. CrossRef ]54. Evans, J.D. Straightforward Statistics for the Behavioral Sciences Thomson Brooks /Cole Publishing Co: ThreeLakes, WI, USA, 1996.55. Buitinck, L.; Louppe, G.; Blondel, M.; Pedregosa, F.; Mueller, A.; Grisel, O.; Niculae, V.; Prettenhofer, P.;Gramfort, A.; Grobler, J. API design for machine learning software: Experiences from the scikit–learn project.arXiv 2013, arXiv:1309.0238.56. Tibshirani, R. Regression shrinkage and selection via the lasso. J. R. Stat. Soc. Ser. 1996,58, 267–288.[CrossRef ]57. Gunn, S.R. Support vector machines for classiﬁcation and regression. ISIS Tech. Rep. 1998,14, 5–16.58. Smola, A.J.; Schölkopf, B. tutorial on support vector regression. Stat. Comput. 2004,14, 199–222. CrossRef ]59. Breiman, L.J.M.l. Random forests. Mach. Learn. 2001,45, 5–32. CrossRef ]60. Sinha, P.; Gaughan, A.E.; Stevens, F.R.; Nieves, J.J.; Sorichetta, A.; Tatem, A.J. Assessing the spatial sensitivityof random forest model: Application in gridded population modeling. Comput. Environ. Urban Syst. 2019,75, 132–145. CrossRef ]61. Wang, Y.; Wu, X.; Chen, Z.; Ren, F.; Feng, L.; Du, Q. Optimizing the Predictive Ability of Machine LearningMethods for Landslide Susceptibility Mapping Using SMOTE for Lishui City in Zhejiang Province, China.Int. J. Environ. Res. Public Health 2019,16, 368. CrossRef ]62. Freund, Y.; Schapire, R.E. decision–theoretic generalization of on–line learning and an application toboosting. J. Comput. Syst. Sci. 1997,55, 119–139. CrossRef ]63. Zhong, L.; Hu, L.; Zhou, H. Deep learning based multi–temporal crop classiﬁcation. Remote Sens. Environ.2019,221, 430–443. CrossRef ]64. Biganzoli, E.; Boracchi, P.; Mariani, L.; Marubini, E. Feed forward neural networks for the analysis of censoredsurvival data: partial logistic regression approach. Stat. Med. 1998,17, 1169–1186. CrossRef ]65. Rojas, R. Neural Networks: Systematic Introduction Springer Science Business Media: Berlin, Germany, 2013.66. Peralta, N.; Assefa, Y.; Du, J.; Barden, C.; Ciampitti, I. Mid–season high–resolution satellite imagery forforecasting site–speciﬁc corn yield. Remote Sens. 2016,8, 848. CrossRef ]67. Maimaitijiang, M.; Sagan, V.; Sidike, P.; Hartling, S.; Esposito, F.; Fritschi, F.B. Soybean yield prediction fromUAV using multimodal data fusion and deep learning. Remote Sens. Environ. 2020, 237. CrossRef ]68. Imran, M.; Stein, A.; Zurita–Milla, R. Using geographically weighted regression kriging for crop yieldmapping in West Africa. Int. J. Geogr. Inf. Sci. 2015,29, 234–257. CrossRef ]69. Cai, R.; Yu, D.; Oppenheimer, M. Estimating the Spatially Varying Responses of Corn Yields toWeatherVariations using GeographicallyWeighted Panel Regression. J. Agric. Resour. Econ. 2014,39, 230–252.70. Moran, P.A.P. Notes on continuous stochastic phenomena. Biometrika 1950,37, 17–23. CrossRef ]71. Maimaitijiang, M.; Ghulam, A.; Sandoval, J.S.O.; Maimaitiyiming, M. Drivers of land cover and land usechanges in St. Louis metropolitan area over the past 40 years characterized by remote sensing and censuspopulation data. Int. J. Appl. Earth Obs. Geoinf. 2015,35, 161–174. CrossRef ]72. Herbek, J.; Lee, C. Comprehensive Guide to Wheat Management in Kentucky University of Kentucky: Lexington,KY, USA, 2009.73. Wu, X.; Liu, H.; Li, X.; Tian, Y.; Mahecha, M.D. Responses of Winter Wheat Yields to Warming–MediatedVernalization Variations Across Temperate Europe. Front. Ecol. Evol. 2017,5, 126. CrossRef ]74. Fontana, D.C.; Potgieter, A.B.; Apan, A. Assessing the relationship between shire winter crop yield andseasonal variability of the MODIS NDVI and EVI images. Appl. GIS 2007,3, 1–16.Remote Sens. 2020,12, 1232 21 of 2175. Labus, M.P.; Nielsen, G.A.; Lawrence, R.L.; Engel, R.; Long, D.S. Wheat yield estimates using multi–temporalNDVI satellite imagery. Int. J. Remote Sens. 2002,23, 4169–4180. CrossRef ]76. Slafer, G.A.; Savin, R. Developmental base temperature in di ↵erent phenological phases of wheat Triticumaestivum ).J. Exp. Bot. 1991,42, 1077–1082. CrossRef ]77. Garg, D.; Sareen, S.; Dalal, S.; Tiwari, R.; Singh, R. Grain ﬁlling duration and temperature pattern inﬂuence onthe performance of wheat genotypes under late planting. Cereal Res. Commun. 2013,41, 500–507. CrossRef ]78. Feng, L.; Li, Y.; Wang, Y.; Du, Q. Estimating hourly and continuous ground–level PM2. concentrations usingan ensemble learning algorithm: The ST–stacking model. Atmos. Environ. 2019,223, 117242. CrossRef ]79. Chlingaryan, A.; Sukkarieh, S.; Whelan, B. Machine learning approaches for crop yield prediction andnitrogen status estimation in precision agriculture: review. Comput. Electron. Agric. 2018,151, 61–69.[CrossRef ]80. Kang, H.-W.; Kang, H.-B. Prediction of crime occurrence from multi–modal data using deep learning.PLoS ONE 2017,12, e0176244. CrossRef ]81. Zhang, N.; Rao, R.S.P.; Salvato, F.; Havelund, J.F.; Møller, I.M.; Thelen, J.J.; Xu, D. MU–LOC:A machine–learning method for predicting mitochondrially localized proteins in plants. Front. PlantSci.2018,9, 634. CrossRef ]82. Borchani, H.; Varando, G.; Bielza, C.; Larrañaga, P. survey on multi-output regression. Wiley Interdiscip.Rev. Data Min. Knowl. Discov. 2015,5, 216–233. CrossRef ]83. Vergara–D íaz, O.; Zaman–Allah, M.A.; Masuka, B.; Hornero, A.; Zarco–Tejada, P.; Prasanna, B.M.; Cairns, J.E.;Araus, J.L. novel remote sensing approach for prediction of maize yield under di ↵erent conditions ofnitrogen fertilization. Front. Plant Sci. 2016,7, 666. CrossRef ]84. Tao, F.; Xiao, D.; Zhang, S.; Zhang, Z.; Rötter, R.P. Wheat yield beneﬁted from increases in minimumtemperature in the Huang–Huai–Hai Plain of China in the past three decades. Agric. For. Meteorol. 2017,239,1–14. CrossRef ]85. Zhao, Y.; Lobell, D.B. Assessing the heterogeneity and persistence of farmers’ maize yield performance acrossthe North China Plain. Field Crop. Res. 2017,205, 55–66. CrossRef ]86. Nawar, S.; Buddenbaum, H.; Hill, J.; Kozak, J. Modeling and mapping of soil salinity with reﬂectancespectroscopy and landsat data using two quantitative methods (PLSR and MARS). Remote Sens. 2014,6,10813–10834. CrossRef ]87. Wang, J.; Ding, J.; Abulimiti, A.; Cai, L. Quantitative estimation of soil salinity by means of di ↵erent modelingmethods and visible–near infrared (VIS–NIR) spectroscopy, Ebinur Lake Wetland, Northwest China. PeerJ2018,6, e4703. CrossRef ][PubMed ]88. Majchrzak, R.N.; Olson, K.R.; Bollero, G.; Nafziger, E.D. Using soil properties to predict wheat yields onIllinois soils. Soil Sci. 2001,166, 267–280. CrossRef ]89. De La Rosa, D.; Cardona, F.; Almorza, J. Crop yield predictions based on properties of soils in Sevilla, Spain.Geoderma 1981,25, 267–274. CrossRef ]©2020 by the authors. Licensee MDPI, Basel, Switzerland. This article is an open accessarticle distributed under the terms and conditions of the Creative Commons Attribution(CC BY) license http://creativecommons.org /licenses /by/4.0/).