Journal of Physics: Conference SeriesPAPER OPEN ACCESSNear infrared spectroscopy detection of thecontent of wheat based on improved deep beliefnetworkTo cite this article: Wenwen Li et al 2017 J. Phys.: Conf. Ser. 887 012046View the article online for updates and enhancements. Related content Far Infrared Spectroscopy Ludwig Genzel -INFRARED SPECTROSCOPY OF THE HERBIG AE-BE STARS. P. M. Harvey -ERRATUM HIGH RESOLUTION INFRARED SPECTROSCOPY OF PLANETARY ATMOSPHERES A. T. Tokunaga This content was downloaded from IP address 174.4.232.78 on 15/07/2020 at 19:271Content from this work may be used under the terms of the Creative Commons Attribution 3.0 licence. Any further distributionof this work must maintain attribution to the author(s) and the title of the work, journal citation and DOI.Published under licence by IOP Publishing Ltd1234567890ISAI2017 IOP PublishingIOP Conf. Series: Journal of Physics: Conf. Series 887 (2017) 012046 doi :10.1088/1742-6596/887/1/012046Near infrared spectroscopy detection of the content of wheat based on improved deep belief network Wenwen Li1, Min Lin1,*, Yongmei Huang1, Huijun Liu1 and Xinqi Zhou2 1College of Metrology and Measurement Engineering, China Jiliang University Hangzhou, China 2Focused Photonics Hangzhou) Inc. Hangzhou 310052, China *Corresponding author, -mail address: linm@cjlu.edu.cn Abstract. In order to solve the complicated problem of traditional detection of the content of Wheat, method for predicting the content of wheat components by near infrared spectroscopy based on improved de ep belief network is proposed. In this paper, wavelet tran sform is used to preprocess near infrared spectroscopy of wheat, and then quantitative analysis model of wheat's moisture, protein and ash content is established by using de ep belief network And combined with the random hidden algorithm, the network mod el is sparse processed, and the sparse network is obtained. So as to improve the accuracy and stability of the network The experimental results show that using the improved de ep of belief network to establish the quantitative analysis model on the content of wheat, and the correlation coefficient of moisture, protein and ash content were 0.99 78, 0.99 28, 0.99 20, standard error of prediction were 0.0 069, 0.0628, 0.0535. Compared with the traditional deep belief network (DBN and the traditional shallow learni ng BP neural network algorithm, the prediction results have been significantly improved. 1. Introduction Wheat is one of the main sources of people's daily food. Wheat is one of the important sources of protein in people's diet. Protein is the nutrients that the body must take every day. Too much or too little intake can affect the body. Therefore, the quality and safety of wheat is directly related to the health of consumers. However, in recent years, adding excessive whitening agent and lime in wheat flour with the purpose of weight gain was repeatedly exposed, which not only has huge negative impact on society, but also harm the health of consumers and food safety serious ly. With the rapid, accurate, non -destructive testing technology is adopted to detect the content of wheat in line with modern high quality of life needs. Near infrared spectroscopy nondestructive testing technology has the advantages of fast, high efficiency, no pollution and no need of sample pretreatment. At present, it has been widely used in food quality analysis [1], fruit quality analysis [2] and many other fields The establishment of an analytical model for moisture, protein and ash in wheat has certain practical significance for wheat quality testing At present, the new methods are emerging, and the popular methods are mainly shallow learning methods such as PLS [3], neural network [4] and Support Vector Machine [5] (SVM). common feature of these networks is that they all use the structure of no more than three layers to transform the original input signal into feature space. There is no doubt that shallow learning is very effective to solve simple problems, in solving complex practical applications, there are many problems such as insufficient expression of function. However, in the same number of nodes, the deep learning network is usually more expressive than the shallow network. 21234567890ISAI2017 IOP PublishingIOP Conf. Series: Journal of Physics: Conf. Series 887 (2017) 012046 doi :10.1088/1742-6596/887/1/012046In this paper, method based on impro ved DBN (deep belief network) is proposed for the determination of wheat component content by near infrared spectroscopy. Wavelet transform can remove the spectral information with the noise in the data and realize effective compression of hyperspectral da ta and reduce the amount of computation model The pretreated data and the corresponding analytical data were used as input to the network model, and the content of wheat components was used as the network output. wheat network model for predicting the omponent content of wheat was established. 2. Deep Belief Network Deep belief network model is composed of plurality of restricted Boltzmann machine RBM) and layer of BP neural network 6]. First, unsupervised training, the first RBM to get the initial weight, and then the training of the output as the next RBM input, layer by layer training, until the training of all the RBM. 2.1. Gauss Restricted Boltzmann Machine In this paper, the Gauss restricted Boltzmann machine is used instead of the restricted Boltzm ann machine And then the Gauss restricted Boltzmann machine model is obtained. The energy model is as follows 2, 2,() 1( )2i ii j i ji j j iiv vE h h v h (1) In the upper form, is bias at the input layer node, is bias of hidden layer nodes, is the connection weight between the input layer node and the hidden layer node, is the standard deviation of the input spectral data All parameters are real numbers. The corresponding conditional probability distribut ions of the visible and hidden layers are as follows ,2,( 1| ( )( 1| ( )ij i ji ii i j ijvp v sigmoid Wp h b h (2) In the upper form ,) 1(1xe sigmoid is Gauss distribution. 2.2. The Training of Deep Belief Networks The training of deep belief network consists of two stages The training process is as follows (a)Unsupervised pre training: physicochemical corresponding near infrared spectra of cotton polyester blended data and Analysis on its val ue as the input of Gauss restricted Boltzmann machine of each layer is trained using unsupervised learning method, and the output of each Gauss restricted Boltzmann machine as the next Gauss restricted Boltzmann machine input. Layer training Gauss restrict ed Boltzmann machine, until the end of the top. (b)Supervised fine tuning: the parameters obtained by pre training are used as initial values of the network, and the whole network is trained with supervised BP network to tune parameters. 2.3. Random Hidden Al gorithm The random hidden algorithm is an implicit model fusion algorithm, which can effectively prevent the overfitting of the model by changing the network structure. In the course of training and training, the random concealment algorithm changes the pr obability parameters of the network layer, which causes the network to hide some hidden layer nodes randomly until the end of training. In this paper, the random hidden algorithm is implemented by changing the network structure. The nodes in the dashed line indicate that they are not involved in training and testing, and the weight is zero, similar to the hidden layer noise reduction method. The random hidden algorithm will change the probability parameters of the network layer, which will cause the network to randomly discard some 31234567890ISAI2017 IOP PublishingIOP Conf. Series: Journal of Physics: Conf. Series 887 (2017) 012046 doi :10.1088/1742-6596/887/1/012046hidden neurons. When the model is trained, the weights of certain hidden layers are changed randomly, so that the weights of all nod es in the hidden layer are 'fused '. 3. Experiment 3.1. Experimental Data In this paper the spectra of wheat samples were obtained by using SupNIR -1520 near infrared spectrometer( Focused Photonics Inc ), and he spectral area is 1000~2500nm. The collected spectral data were processed by MATLAB2015a software. total of 400 wheat samples were collected, and their moisture, protein and ash contents were determined by quantitative chemical analysis. The near infrared spectroscopy of wheat are shown in Figure . Figure 1. The original near infrared spectroscopy of Wheat 3.2. Preprocessing of the Original Spectrum The original spectrum contains irrelevant information a lot of redundant information in the spectrum will increase the complexity of the model, and even affe ct the prediction accuracy In order to reduce the influence of various interference factors on the performance of the correction model, it is necessary to preprocess the original spectral data. The wavelet transform is used to process the original spectra data. Wavelet transform can separate noise and real spectral signals, and highlight spectral information, and compress the spectral data. The method entails using db3 wavelet at levels decomposition to process original spectral data The compressed nea r-infrared spectrum data matrix is obtained, and the compressed spectral data points are reduced to 13% of the original data, the energy retention rate is 99%. The spectrum after the wavelet transform is shown in Figure . Figure 2. Near infrared spectro scopy of wheat after wavelet transformation 41234567890ISAI2017 IOP PublishingIOP Conf. Series: Journal of Physics: Conf. Series 887 (2017) 012046 doi :10.1088/1742-6596/887/1/0120463.3. Partition of Sample Set The establishment of quantitative analysis of near infrared spectra requires the selection of reasonable and representative sample sets. The training set sample data limits the applicable range and prediction accuracy of the model. Therefore, this paper used SPXY algorithm according to the ratio of 3:1 to divide 400 samples The method can guarantee the uniform distribution of the spatial distance of the sample spectral data, and make the amples evenly distributed in the training set and the prediction set, so as to ensure the rationality and representativeness of the sample set. The training set is used to establish the analytical model, and the prediction set is used to test the reliabili ty and stability of the model. The training set has 300 samples, and the prediction set has 100 samples. 3.4. Determination of Network Model The random hidden algorithm changes the structure of the network model by hiding the hidden layer nodes, thus improving the stability and prediction accuracy of the network. Set the probability of random concealment, the initial value is 0.05, and then increase to by 0.05 for the step size, then train under the probability parameters, and compare the prediction results. he experimental results show that the network model with stable and higher prediction accuracy can be obtained when the random concealment parameter is set to 0.6. 4. Results of Experiment and Discussions 300 training set samples and 100 prediction set sample of wheat near infrared spectrum data were collected as input data of improved DBN The improved DBN method for the determination of the content of wheat components is as follows (a) Inputing the spectral data of training set to the RBM in the underlyi ng layer. The learning rate of the connection weight between the hidden layer and the visual layer, the learning rate of the visual layer and the hidden layer bias are initialized to 0.1 (b) The output of the bottom RBM is used as the input of the DBN, and the weights and offsets of the previous RBM are kept unchanged. Using the state of the hidden layer neuron to train the next RBM, and then output the result of the parameter vector. (c) The connection weights of hidden layer nodes are obtained by pre raining to initialize corresponding nodes And the probability ratio of random hidden algorithm is 0.6, the learning rate is 0.1. The network is trained by the function of neural network, and the hidden layer nodes are discarded randomly. (d) Using stocha stic gradient descent method to update the weights, and train them many times until convergence. (e) The parameters that are iterated by random concealment algorithm are used as the optimal values, and the predicted data is input into the trained network or prediction. The experiment was repeated several times and analyzed and compared with the simulation results. The experimental results were obtained. In accordance with the improved DBN model established in this paper, the NIR spectra of wheat were predi cted. The results are compared with the traditional eep belief network model and the traditional shallow learning BP neural network, the results are shown in table 1. Table 1. The prediction results obtained by different modeling methods. BP neural network Deep belief network Improved eep Belief Network RMSEP RMSEP RMSEP Moisture 0.9322 0.3245 0.9327 0.2523 0.9978 0.0069 Protein 0.9212 0.5236 0.9145 0.3652 0.9928 0.0628 Ash 0.88815 0.6525 0.9121 0.3225 0.9920 0.0535 51234567890ISAI2017 IOP PublishingIOP Conf. Series: Journal of Physics: Conf. Series 887 (2017) 012046 doi :10.1088/1742-6596/887/1/012046As can be seen from table . Compared with the traditional DBN prediction method and the traditional shallow learning BP neural network, the improved DBN based prediction method proposed in this paper has significantly improved the prediction results. The wheat near infrared spectroscopy model using the improved DBN based analysis, the correlation coefficient of moisture, protein, ash content prediction can reach more than 0.99, the moisture, protein and ash content of the forecast result and the real value of fitting curve s shown in figure 3, figure and figure 5. Figure 3. Fitting curves of predicted result and true value of moisture content in wheat Figure 4. Fitting curves of predicted results and true value of protein content in wheat 61234567890ISAI2017 IOP PublishingIOP Conf. Series: Journal of Physics: Conf. Series 887 (2017) 012046 doi :10.1088/1742-6596/887/1/012046 Figure 5. Fitting curves of predicted results and true value of ash content in wheat 5. Conclusion The research work shows that it is feasible to use the near infrared spectroscopy and the improved DBN algorithm to detect the content of wheat components. Moreover, this method is also applicable to the detection of other agricultural products. An improved DBN network model is seen as deep learning model Firstly, the wavelet transform method is used to preprocess the original spectra of Whea t. Then, DBN is combined wit random hidden algorithm, and the sparse structure of the network model is realized by changing the structure of the network, and the sparse network is obtained Finally, using the improved DBN method to model and predict on the content of wheat, the correlation coefficient of prediction of the corresponding moisture, protein and ash content were 0.99 78, 0.9928 and 0.9920, the predicted standard deviation were 0.0 069,0.0628 and 0.0535 The experimental results prove that the model has good stability and accuracy, and enrich the modeling algorithm of near infrared spectroscopy technology, and lay the foundation for the transmission and sharing of the model. 6. Acknowle dgment This work is supported by National major scientific instruments and equipment development projects (2014YQ470377).The authors awfully thanks for anonymous reviewers who made constructive comments. 7. References [1] Shiroma C, Rodriguez -Saona L. Journal of Food Composition &Analysis 2009, 22( 6): 596 -605. [2] Nicolai M, Verlinden E, Desment M, et al. Postharvest Biology Technology 2008, 47( 1): 68-74. [3] Ahmed Al -Harrasi et al. Application of NIRS coupled with PLS regression as rapid, non -destructive alternative method for quantification of KBA in Boswellia sacra J]. Spectrochimica Acta Part A: Molecular Biomolecular Spectroscopy 2017 184:277. [4] LI Bao Jian CHENG Chun Tian. Monthly discharge forecasting using wavelet neural networks with extreme learning machine J]. Science China Technological Sciences) 2014, 12):2441 -2452. [5] Nassim Laouti Sami Othman Mazen Alamir,Nida Sheibat -Othman. Combination of Model -based Observer and Support Vector Machines for Fault Detection of Wind Turbines J]. International Journal of Automation amp; Computing 2014, (03): 274-287. [6] Hinton E. practical guide to training restricted Boltzmann machines [J]. Momentum 201 2, 9(1): 599-619.