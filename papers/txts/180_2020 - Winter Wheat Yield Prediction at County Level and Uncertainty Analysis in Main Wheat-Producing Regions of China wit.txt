remote sensing ArticleWinter Wheat Yield Prediction at County Level andUncertainty Analysis in Main Wheat-ProducingRegions of China with Deep Learning ApproachesXinlei Wang1, Jianxi Huang1,2,*, Quanlong Feng1and Dongqin Yin1,21College of Land Science and Technology, China Agricultural University, No. 17 Qinghua East Road,Haidian District, Beijing 100083, China; w_xinlei1020@cau.edu.cn (X.W.); fengql@cau.edu.cn (Q.F.);dongqin.yin@cau.edu.cn (D.Y.)2Key Laboratory of Remote Sensing for Agri-Hazards, Ministry of Agriculture and Rural Affairs,Beijing 100083, China*Correspondence: jxhuang@cau.edu.cn; Tel./Fax: +86-010-6273-7855Received: 16 April 2020; Accepted: 21 May 2020; Published: 28 May 2020/gid00030/gid00035/gid00032/gid00030/gid00038/gid00001/gid00033/gid00042/gid00045/gid00001/gid00048/gid00043/gid00031/gid00028/gid00047/gid00032/gid00046Abstract:Timely and accurate forecasting of crop yields is crucial to food security and sustainabledevelopment in the agricultural sector. However, winter wheat yield estimation and forecastingon regional scale still remains challenging. In this study, we established two-branch deeplearning model to predict winter wheat yield in the main producing regions of China at the countylevel. The ﬁrst branch of the model was constructed based on the Long Short-Term Memory(LSTM) networks with inputs from meteorological and remote sensing data. Another branch wasconstructed using Convolution Neural Networks (CNN) to model static soil features. The modelwas then trained using the detrended statistical yield data during 1982 to 2015 and evaluatedby leave-one-year-out-validation. The evaluation results showed promising performance of themodel with the overall R2and RMSE of 0.77 and 721 kg/ha, respectively. We further conductedyield prediction and uncertainty analysis based on the two-branch model and obtained the forecastaccuracy in one month prior to harvest of 0.75 and 732 kg/ha. Results also showed that while yielddetrending could potentially introduce higher uncertainty, it had the advantage of improving themodel performance in yield prediction.Keywords:remote sensing; winter wheat; crop yield prediction; yield detrending; deep learning; uncertainty1. IntroductionWheat is one of the three staple foods in China, and plays an important role in maintaining foodsupply and security. Timely and accurate wheat yield information on the national scale is of greatsigniﬁcance for agricultural decision making and sustainable developments. The grain yield is affectedby multiple factors, such as soil quality, weather conditions, ﬁeld management practices, agriculturalsubsidy policy, and the market prices of grain. For example, high grain prices usually encouragefarmers to invest more resources to achieve higher yields [1]. In addition, many of these factors have anon-linear relationship with yield and some factors such as weather, soil, and applied nutrients areinterrelated in complex agroecosystem [2,3]. Thus, wheat yield forecasting over large spatial regionsstill remains challenge.Several methods have been developed to forecast crop yields using remotely sensed data in thelast few decades [2]. One of the main categories is the data assimilation method, which retrieves cropstatus variables, such as Leaf Area Index (LAI) and Evapotranspiration (ET) from remotely sensed data,and uses these variables as inputs to re-calibrate and optimize the grain yield simulation ability of thecrop growth model [4–7]. There are two main challenges of the data assimilation method. The ﬁrst isRemote Sens.2020,12, 1744; doi:10.3390/rs12111744www.mdpi.com/journal/remotesensingRemote Sens. 2020,12, 1744 of 20the requirement of local calibration and numerous crop speciﬁc inputs (such as crop characteristics,ﬁeld management practices, meteorological and soil data) to simulate crop growth and developmentthrough the crop cycle 8,9]. The second is higher resolution of observations result in an increasedcomputational cost for data assimilation system, which makes it difﬁcult to operate at large scale inpractical application 10]. Another category of models are statistical regression-based methods whichare the most commonly used methods for regional crop yield forecasting 11–13]. These methodsare based on empirical relationships between historical yields and remote sensing derived variablessuch as the Normalized Difference Vegetation Index (NDVI) from AVHRR or MODIS satellite data.They are typically straightforward to implement without requiring numerous inputs. One of the maindrawbacks of these empirical approaches is that the relationships used are typically localized and noteasy to extend to other agricultural regions 8,14].In recent years, machine learning and deep learning techniques have been successfully applied inmany areas, such as image recognition, language translation, and signal processing 15]. Traditionalmachine learning methods such as Support Vector Machine (SVM) and Random Forest (RF) havebeen widely used in satellite image classiﬁcation 16,17], parameter inversion 18], and crop yieldprediction 19–21]. Meanwhile, deep learning techniques often achieve better performance comparedwith traditional machine learning methods 22–24]. Subsequently, Convolution Neural Networks(CNN) and Long Short-Term Memory (LSTM) 25] networks, which are the most popular modelsamong deep learning techniques, have been applied to crop yield estimation and forecasting.For example, You 26] proposed deep learning framework to predict crop yield, which was trained bya new form of feature representation based on histograms of raw images. The model achieveda high accuracy and demonstrated good ability in terms of transfer learning 27]. However,this method needs large number of pixels in region to generate the histograms, which limitstheir application regarding low spatial resolution images or yield prediction on the smaller scale.In addition, the commonly used representation of spatial aggregation can also be used in the deeplearning models such as one dimensional CNN 28] or LSTM 29,30]. Both Oliveira 30] and Jiang 29]used LSTM to build their crop yield prediction model, using meteorological data and soil data.The difference between them is the former just kept soil data the same in all time steps and input theminto LSTM directly, while the latter added the soil data from the fully connected layer of their neuralnetworks model. However, the combination of remote sensing data, meteorological data, and soil datais rarely explored. Moreover, most of these deep learning methods did not quantify the uncertainty ofmodel’s outputs. It is important to know the conﬁdence of prediction because knowing the uncertaintyof yield prediction is beneﬁcial to farmer decision making and policy makers to maximize proﬁts andreduce losses 1]. Therefore, the potential of using deep learning in regional crop yield prediction hasnot been fully explored.Yield trend is another issue that is not considered in machine learning methods when the trainingdata come from wide range of years. Chinese wheat yield has been increased rapidly (more than1% annually 31]) during recent decades, mainly due to new varieties, improved crop managementtechnologies and policy reform 31–33]. There are some commonly used methods to detrend yielddata including the linear model, quadratic model, cubic model, moving averaging, and so on 34–36].These detrending methods generally use the year as the independent variable to obtain yield trends.The detrended yield, termed “yield anomalies” 36], is assumed to be correlated with the annualvariability of weather conditions, such as water stress.In this study, the winter wheat yield in the main producing area of China was estimated at thecounty level using deep learning methods based on long-term statistical yields and multi-sourcedata. The main purposes of this study are: (1) to explore the feasibility of deep learning-based yieldforecasting with long-term historical yield data; (2) to demonstrate the necessity of yield detrending andthe impact of socioeconomic factors in yield estimation; (3) to quantitatively evaluate the uncertaintyof the yield prediction model using Gal’s methods 37].Remote Sens. 2020,12, 1744 of 202. Materials and Methods2.1. Study AreaThe study focuses on winter wheat planting regions in China (Figure 1), including most areas ofHebei, Henan, Shandong, and Jiangsu province, north of Anhui and Hubei province, southwesternShanxi province, central Shaanxi province, east of Gansu and Sichuan province, extending from 103Eto 122E and from 28N to 40N. It includes two main winter wheat growing regions: the northernand the southern areas. The northern area is located to the south of the Great Wall, north of QinlingMountain and Huaihe River, where winter wheat planting acreage and production account for 60% ofthe country. The northern area has temperate continental monsoon climate, with an annual averagetemperature of 9–15C and an annual rainfall of 440–980 mm. The main prevailing rotation mode iswinter wheat and summer corn. The southern area is located to the south of Qinling Mountain andHuaihe River, with subtropical monsoon climate, an annual average temperature of 16–24C and anannual precipitation more than 1000 mm. Winter wheat is mostly rotated with paddy rice in this area.Figure 1. The study area which is the main winter wheat producing areas in China.2.2. Datasets and Preprocessing2.2.1. Satellite DataThe Advanced Very High Resolution Radiometer (AVHRR, 0.05 arc degrees, daily) surfacereﬂectance 38] were chosen as our satellite data source given its long-term observation and suitabletemporal resolution. The bands “SREFL_CH1” (red band), “SREFL_CH2” (near-infrared band),“SREFL_CH3” (thermal infrared band), and the Normalized Difference Vegetation (NDVI) wereselected as remote sensing input data.2.2.2. Meteorological DataWeather conditions play vital role during crop growing season. The China MeteorologicalForcing Dataset from the Institute of Tibetan Plateau Research, Chinese Academy of Sciences 39–41]was used as meteorological input data. This dataset provides seven meteorological variables (Table 1)including temperature, precipitation, air pressure, air speciﬁc humidity, downward shortwaveradiation, downward longwave radiation, and wind speed, at spatial resolution of 0.1 degreesand temporal resolution of h. These variables are usually used as drivers for crop models to simulatethe growing processes of crops, since they affect crops in different ways during growing stages.We expected to establish these effects on crops using our neural networks model.Remote Sens. 2020,12, 1744 of 202.2.3. Soil DataSoil properties largely determine the spatial variability of crop yields when the weather is idealand the crop management is in the same condition. Previous work 30] also demonstrated that soilquality is relevant for crop yield prediction, which provides complementary information and increasesyield prediction accuracy. In this study, the SoilGrids dataset was used, which is global gridded soilinformation dataset, with spatial resolution of km or 250 [ 42,43]. We chose SoilGrids 250 as soilinputs, which were predicted by an ensemble of machine learning methods ﬁtted using 150,000 soilproﬁles and 158 remote sensing-based covariates 42]. This dataset includes nine soil features (listed inTable 1) describing the physical and chemical properties of the soil in seven layers of depth from to200 cm.Table 1. Detailed information of the input features.Data Source Feature Name Unit DescriptionRemotesensingdata ofAVHRRSREFL_CH1 Surface reﬂectance (640 nm)SREFL_CH2 Surface reﬂectance (860 nm)SREFL_CH3 Surface reﬂectance (3750 nm)NDVI Normalized Difference Vegetation IndexMeteorologicaldataTEMP Instantaneous near surface (2 m) air temperaturePREC mm hr1Precipitation ratePRES Pa Instantaneous near surface (2 m) air pressureSHUM kg kg1Instantaneous near surface (2 m) air speciﬁc humidityLRAD m2Surface downward longwave radiationSRAD m2Surface downward shortwave radiationWIND s1Instantaneous near surface (10 m) wind speedSoil dataBLDFIE kg m3Bulk density (ﬁne earth)CECSOL cmolc kg1Cation exchange capacity of soilCLYPPT Clay content (0–2 micrometer) mass fractionCRFVOL Coarse fragments volumetricORCDRC kg1Soil organic carbon content (ﬁne earth fraction)PHIHOX PH ⇥10 in H2OPHIKCL PH ⇥10 in KCLSLTPPT Silt content (2-50 micrometer) mass fractionSNDPPT Sand content (50-2000 micrometer) mass fraction2.2.4. Cropland DataIt is difﬁcult to obtain the speciﬁc crop planting map for all individual years from 1982 to2015. Several previous studies 44–46] compared the use of crop speciﬁc mask and generalizedcropland mask for crop yield prediction. Although there could be some loss of accuracy in some cases,generalized cropland mask can still be used for crop yield prediction. Furthermore, according to thedata of National Bureau of Statistics http://data.stats.gov.cn/ ), winter wheat is the dominant cropin winter season over our study area, which could account for more than 90% of the total plantingarea among summer grain crops (Winter wheat in China is harvested in summer). Thus, croplanddata were used as the wheat mask in the present study. The cropland product was downloaded fromEuropean Space Agency Climate Change Initiative (ESA CCI), which provides annual land cover mapsfrom the year 1992 to 2015 with spatial resolution of 300 m. This dataset is kept updating and can beused in practical application for yield prediction of current year.2.2.5. Yield Data and DetrendingThe county-level yield data in 1982–2015 was collected manually from local statistical yearbookswhich were not published online (data for the years 1983, 1995, and 2006 were missing). Counties withRemote Sens. 2020,12, 1744 of 20a winter wheat planting area greater than 10,000 ha and more than 25 years of records were selected asour modeling and analysis samples (Figure 1). There were in total 11,444 yield records after ﬁltering.As shown in Figure S2, the model was not able to learn the temporal trend of the yield whenusing the statistical yield data to train it. Thus, in hindsight, it is necessary to detrend yield data in themodeling process when the yield data are from wide range of years. The trend of yields was assumedas linear (Figure 2) and removed while keeping the spatial variability in each year by calculatingrelative yields. We ﬁrst calculated the area weighted average yield (kg/ha) of all counties in everyyear. Then, for each year, the trend yield was obtained using linear regression with weighted averageyields of other years. Finally, the relative yield (Equation 1)) was applied to all county-level yield datausing the trend yield in the corresponding year. Here, the trend yields can be seen as average yieldlevel of the whole study area. The relative yield indicates the relative difference between the statisticalyield at the county level and the average yield in the study area. The relative yields were used to trainour deep learning model to avoid the impact of trend. In practical application, to predict the yield foran individual year, we just need to predict the relative yield using the trained model and get the trendyield of this year using linear regression as the trend was assumed to be linear. Then the predictedyield (kg/ha) can be calculated reversely using Equation 1). The distribution difference (Figure 3)between the actual yields and relative yields indicates that the yield level varies with time withoutdetrending (Figure 3a). However, zero-mean distribution (Figure 3b) was achieved using relativeyields which means the trend is removed acceptably.y0i=yi¯ytrend¯ytrend(1)where yiis single county-level yield record, and ¯ytrendis the trend yield of the whole study area inthe corresponding year.Figure 2. The yearly area weighted average yield calculated from county-level yields in the wholestudy area and its linear trend.Remote Sens. 2020,12, 1744 of 20(a) Distribution of actual yields.(b) Distribution of relative yields.Figure 3. comparison between the distributions of actual wheat yields and relative yields from 1982to 2015 in central China.2.2.6. Data PreprocessingRemote sensing data were processed on the Google Earth Engine (GEE) 47], which is aplanetary-scale platform for earth science data and analysis (The GEE code was shared https://drive.google.com/ﬁle/d/1m7-LhpfIoFU8LrvaSQGgQn00cSxV-aCt/view?usp=sharing ). Meteorologicaldata and soil data were downloaded and processed on desktop computer using GDAL (The GeospatialData Abstraction Library). Although the surface reﬂectance data are daily, the time series has somemissing values and ﬂuctuates as result of noise. To reduce the noise, we produced stable 8-day intervaltime series by maximum-value composite 48], and cropland masking was applied synchronously.Meteorological data were also aggregated every 8-day interval to keep the same time length as theremote sensing data. All remote sensing data, meteorological data, and soil data were spatiallyaggregated to the mean for each county with county boundaries. Invalid data were deleted andinterpolated and each variable was normalized to 0–1 using its maximum and minimum values.Finally, all the time series had length of 32 for each year, covering the entire growing season of winterwheat (from October to the middle of June in the following year).2.3. Model Development2.3.1. Deep Neural Network StructureRemote sensing and meteorological data change dynamically during crop growing season;however, soil properties can be assumed to be constant. According to different structures of dynamicand static features, the model was split into two components (see model structure in Figure 4).Remote Sens. 2020,12, 1744 of 20The dynamic features were input into LSTM network which is adept at processing time series data,and the static features were fed into one-dimensional CNN to extract the vertical features from themulti-depth soil properties. The number of units in the LSTM cell was 32. As for the CNN component,there were four convolutional layers and the kernel size was 3. The dimensions of ﬁlters in these fourlayers were 128, 128, 256, and 256, and the strides were 1, 2, 1, 2, respectively. Both of the componentswere merged from the fully connected layer. The activation function is ReLU 49].Figure 4. Overall structure of the deep learning model for wheat yield forecasting.2.3.2. Quantiﬁcation of Prediction UncertaintyIt is important to quantify the prediction uncertainty of the yield regression model. The predictionuncertainty can be divided into aleatoric and epistemic uncertainties on the basis of differentsources 50]. Aleatoric uncertainty comes from observation noise while epistemic uncertainty accountsfor the uncertainty of the model. Kendall and Gal’s 37] methods were used to estimate these twotypes of uncertainties in the present study.An adjusted loss function (Equation 2)) was used to estimate heteroscedastic aleatoric uncertaintywith an assumption that observation noise can vary with different samples. This was achieved bysplitting the last fully connected layer into two outputs (Figure 4), therefore, both of the f(xi)ands(xi)could be learned simultaneously. Epistemic uncertainty was estimated using Monte Carlo dropout 51],which can be interpreted as Bayesian approximation. In practice, the model needed to dropout beforeevery weight layer and also used the dropout at the test time for the many forward passes, which wasa sampling process from the approximate posterior.LNN(q)=1NNÂi=112s(xi)2kyif(xi)k2+12logs(xi)2(2)2.3.3. Implementation DetailsWe used TensorFlow (GPU version 1.15) 52], Python’s deep learning library, to construct andtrain our neural network model. All weights of the network were initialized by He initialization 53],and biases were initialized using zero. The loss function (Equation 2)) was used to optimize parameters.The initial learning rate was set to 0.0005 and the Adam optimizer 54] was applied to minimize theloss because of its ability to adjust the learning rate during the training stage. The batch size is 64 andthe network was trained for 50 epochs, then the best model was saved during training.Remote Sens. 2020,12, 1744 of 202.4. Model Evaluation MetricsWe chose Normalized Root Mean Square Error (NRMSE), Coefﬁcient Of Determination (R2),and Mean Absolute Percentage Error (MAPE), the three metrics in Equations 4)–(6), and schedule ofleave-one-year-out-validation 55–57] to evaluate our model’s accuracy. In other words, for each year,the model was trained using yield data from other years and validated using yield data from that year.There were total of 11,444 yield samples. The sample size for each year was not exactly the same,varying between 300 and 400. This form of validation guarantees that the prediction of the model ineach year is unbiased by information of the year to be predicted. It should be noted that NRMSE ismore reasonable than RMSE when the model is validated yearly because the levels of yield changewith the year.RMSE =s1nnÂi=1⇣ˆyiyi⌘2(3)NRMSE =RMSE¯y(4)R2=1Âni=1⇣ˆyiyi⌘2Âni=1⇣yi¯y⌘2(5)MAPE =100%nnÂi=1ˆyiyiyi(6)3. Results3.1. Model AccuracyFigure S2 shows the scatter plots of every year with the three accuracy metrics. Generally,the accuracy in recent years is higher than in early years. The overall R2, RMSE, and MAPE of allsamples are 0.77, 721 kg/ha, and 15.38%, respectively, which were calculated using the predicted valueof all the samples using leave-one-year-out-validation.We also calculated the three accuracy metrics for each county in all the years. The spatialdistributions of R2, NRMSE, and MAPE (Figures 5–7) show that the R2values in more than 80%of counties are positive and greater than 0.5, indicating that the model can explain more than 50%of the time variability for these counties. The NRMSE and MAPE are less than 0.2 and 20% formost counties, respectively. Generally, higher errors are observed in northwestern provinces (Shanxi,Shaanxi, and Gansu) since most of the cropland in these regions is rainfed (Figure S3) and the plantingdensity of wheat is low, while most of the North China Plain is irrigated with high planting density.Yields in rainfed areas are generally lower than those in irrigated areas (Figure S4). Yield data fromirrigated areas is much more than that from rainfed areas and the inputs of our model did not includeirrigation data of different areas. Besides, the generalized cropland mask was used in this study ratherthan the winter wheat mask. These factors would limit the model’s performance in rainfed areas andnon-wheat dominant areas. This is one of the reasons that low yields were overestimated, as shownin the scatter plots of Figure S2. Another reason could be that the sample sizes of the low yield andhigh yield were smaller than that of the middle yield. The model was trained by this unbalancedsample distribution, which caused the model to tend towards predicting the middle yield. In addition,training deep learning models needs large amount of data, and the total of 11,444 samples in thisstudy may not be sufﬁcient to obtain better results in the low and high ends of the yield. As result,low yields were overestimated and high yields were underestimated, especially in the early years.Remote Sens. 2020,12, 1744 of 20Figure 5. Spatial distribution of the Coefﬁcient Of Determination (R2) calculated from the predictedyields of all the years for each county. The inset panel in the upper left is the histogram of R2.Figure 6. Spatial distribution of the Normalized Root Mean Square Error (NRMSE) calculated fromthe predicted yields of all the years for each county. The inset panel in the upper left is the histogramof NRMSE.Remote Sens. 2020,12, 1744 10 of 20Figure 7. Spatial distribution of the Mean Absolute Percentage Error (MAPE) calculated from thepredicted yields of all the years for each county. The inset panel in the upper left is the histogramof MAPE.3.2. Impact of Different Data Sources on Model AccuracyTo evaluate the yield prediction performance on different data sources, we performed an analysison several combinations of data sources, and the overall accuracies are listed in Table 2. Comparedwith meteorological data, using remote sensing data alone achieved higher accuracy with an R2of 0.58, RMSE of 969 kg/ha, and MAPE of 21.04%, because remote sensing data are more directand more comprehensive observation of crop growing status. In addition, there is supposed to behigher accuracy if using winter wheat masks. On the other hand, most regions of the study area areirrigated, which may weaken the impact of weather conditions. The combination of remote sensingand meteorological data shows slight increase in accuracy compared with remote sensing data alone,which means that the contributions from them are overlap to great extent.Table 2. Model accuracy using different combinations of data sources.Combination of Data Sources R2RMSE (kg/hm2) MAPERemote sensing data 0.58 969 21.04%Meteorological data 0.50 1051 22.20%Remote sensing data, Meteorological data 0.60 945 19.94%Remote sensing data, Meteorological data and soil data 0.77 721 15.28%Remote Sens. 2020,12, 1744 11 of 20The accuracy shows great improvement when soil information is added (Table 2). The overall R2,RMSE, MAPE values are 0.60, 945 kg/hm2, 19.94%, respectively, when the model was trained withoutthe soil branch. However, these values are 0.77, 721 kg/ha, and 15.38% with the soil branch. Figure 8shows the difference in NRMSE with and without the soil branch. There is about 20% improvementin model accuracy, which indicates the addition of soil data improved model’s ability of capturingspatial variability of yield.It should be noted that the soil information was constant for each county in all the years whentraining the model. To show whether the model is overﬁtted on soil information, we implementedcross-validation based on location by randomly selecting yield samples from 70% of the counties totrain the model and used samples from the other counties to validate. This validation was performedten times and average accuracy metrics were calculated using accuracy metrics of these ten times(Table 3). The results show that there is no obvious overﬁtting, which means the model is generalizedand can be used to estimate the yield in the counties where the statistical yield is not available.Table 3. Cross-validation of model with random split from ten rounds. For each round, samples of70% of the counties were used to train, the other samples were used to validate.Round Dataset R2RMSE (kg/ha) MAPE (%)1train 0.82 643 13.03test 0.75 706 14.81change 0.07 +63 +1.782train 0.82 630 13.03test 0.77 758 16.04change 0.05 +128 +3.014train 0.85 588 12.15test 0.74 727 15.15change 0.11 +139 +3.005train 0.83 608 12.84test 0.81 668 13.85change 0.02 +60 +1.016train 0.84 607 12.87test 0.73 753 15.08change 0.11 +146 +2.217train 0.84 609 12.17test 0.79 665 14.45change 0.05 +56 +2.288train 0.83 631 13.08test 0.76 681 13.85change 0.07 +50 +0.779train 0.84 595 12.83test 0.74 740 13.83change 0.1 +145 +1.0010train 0.83 618 13.17test 0.76 724 15.34change 0.07 +106 +2.17Averagetrain 0.83 614 12.77test 0.76 712 14.63change 0.07 +98 +1.86Remote Sens. 2020,12, 1744 12 of 20Figure 8. Effect of soil information on accuracy. “Change of NRMSE” is the improvement in NRMSEwith the addition of soil data.3.3. Improvement in Yield DetrendingAs shown in Figure 9a, the model without the detrending yield produced highly biased resultswhereby the predicted yields are overestimated in the early years and underestimated in recent years,indicating the model is not able to capture the increasing trend of the yield caused by advancementin crop variety, technology, and ﬁeld management. Figure 9compares the predicted average yieldof all counties in all years before and after yield detrending. When the model was trained using therelative yields, the overall R2, RMSE, MAPE are 0.77, 721 kg/ha, and 15.38%, while they are 0.23,1312 kg/ha, and 24.4% without detrending (results of every year are shown in Figures S1 and S2).The improvement in accuracy is signiﬁcant, and there is more consistent trend (Figure 9b) with thestatistical average yield.(a) (b)Figure 9. The predicted average yield of all counties before and after detrending. The red solid line isthe average yield of all county-level yield data. a) The predicted average yield of all counties beforedetrending; b) The predicted average yield of all counties after detrending.3.4. Comparison with Machine Learning MethodsTo further evaluate the model performance, we compared the proposed deep learning modelwith other machine learning methods, including random forest, support vector machine, and lassoregression, the parameters of which were optimized to reach as high an accuracy as possible.These machine learning models were performed using scikit-learn, which is machine learningpackage in Python. Table 4shows the overall accuracy of these models. The results indicate that theproposed model outperforms these machine learning approaches, because deep learning models have abetter ability to model high-level feature representation through hierarchical learning framework 58].Remote Sens. 2020,12, 1744 13 of 20Table 4. Model accuracy using different combinations of data sources.Method R2RMSE (kg/hm2) MAPEProposed 0.77 721 15.28%Random Forest 0.72 792 17.03%Support Vector Machine 0.57 981 20.30%Lasso Regression 0.60 949 20.52%3.5. Quantiﬁed UncertaintyAs described in Section 2.3.2, the model can estimate the uncertainty of each output, which isregarded as the conﬁdence interval of model prediction. We randomly chose some counties to showthe changes of their yields and uncertainty over years in Figure 10. The scatter plots on right side of theﬁgure indicate the prediction accuracy of these counties. It can be seen that the aleatoric uncertainty isgenerally greater than the epistemic uncertainty.Figure 10. Predicted results of three randomly chosen counties.Remote Sens. 2020,12, 1744 14 of 203.6. Yield Forecast AbilityA permutation test 59] was performed to evaluate the relative importance of different monthsthroughout the growth period of winter wheat. By permuting the data of speciﬁc period, if the lossof accuracy is large compared to the model with complete data, we can conclude that the data duringthis period has great inﬂuence on the ﬁnal yield prediction. The results (Figure 11) show that Aprilis the most important growth period, in which the heading stage of winter wheat occurs. Therefore,we trained the model using data obtained before May to test the forecast ability. The overall R2, RMSE,and MAPE of the prediction in early May are 0.75, 732 kg/ha, and 15.8%, respectively. There is smalldecrease in accuracy compared to the result using data in the full growing stages. Therefore, the resultssuggest that it is possible to predict wheat yield one month before harvest, indicating the high forecastability of the model.Figure 11. Loss of model accuracy after permuting data of different months compared to the modelusing complete data.4. Discussion4.1. Uncertainty Changes Caused by Yield DetrendingAlthough the model accuracy improved when trained by the relative yield, the aleatoricuncertainty shows signiﬁcant increase (Figure 12). On average, the aleatoric uncertainties beforeand after detrending are 27 kg/ha and 752 kg/ha, the epistemic uncertainties are 238 kg/ha and171 kg/ha respectively. The aleatoric uncertainty before yield detrending is small and almostconstant, indicating the homoscedastic aleatoric uncertainty. In contrast, it is apparent that yielddetrending brings more noise to the labels and this noise varies with different samples, correspondingto heteroscedastic aleatoric uncertainty. The difference between the homoscedastic and heteroscedasticaleatoric uncertainty was explained by Gal 60] with some demonstrations. The reason for this changeis that overall trend was used in our detrending method instead of trends in individual counties;Remote Sens. 2020,12, 1744 15 of 20however, the increasing rates of yield are different for each county. As result, the aleatoric uncertaintyrises signiﬁcantly. On the other hand, the epistemic uncertainty decreased slightly. The epistemicuncertainty comes from the model structure and parameters. The decrease in epistemic uncertainty isthought to be caused by the model parameters since the model structure was the same before and afterdetrending. For the sample subset of each year, the joint distribution of inputs and outputs is closerto the results of all samples than those without detrending. Reduction of out-of-distribution samplesin individual years helps to reduce epistemic uncertainty 37]. This change of uncertainty indicatesthat the deep learning model becomes more robust if trained by the relative yield. Nevertheless,the requirements for detrending could be main limitation in this study and future studies are neededto better model the yield trend.Figure 12. Uncertainty changes before and after detrending yield.4.2. Impact of Agricultural PoliciesYields were overestimated with high biases during 2000 to 2003, which can be observed from thescatter plots in Figure S1 and the plot in Figure 9b. The main reason for that is the changing agriculturalpolicies during these years. Grain supply exceeded demand and storage increased at the end of the1990s because of the increasing production. Furthermore, the Chinese government have not issuedproduction targets since 2001, resulting in fast decrease in the winter wheat planting area duringthe adjustment of the crop planting structure. In addition, there was stagnation of yield growth inmany regions caused by the planting area reduction in low-quality and high-yield varieties, but anincrease in high-quality and low-yield varieties. As result, grain production reached low point in2003. In year 2004, the market grain price began to increase because of high demand and low storage.The government introduced series of agricultural subsidy policies such as minimum purchase pricesand subsidies to encourage grain production. Farmers were motivated by these policies and put moreinputs such as fertilizer, pesticides, and machinery into agricultural production, making the plantingarea, yield, and production start to increase again 61,62].In addition, severe agro-meteorological disasters could be another possible reason for the highbiases in the yield prediction from 2000 to 2003 (Figure S1 and Figure 9b). The main hazard for winterwheat in China is drought; this is based on an analysis of the records of agro-meteorological stationsand statistics 63]. However, the biases are so high that it could not even be caused by the severeRemote Sens. 2020,12, 1744 16 of 20drought during 2000 to 2003. Therefore, we suggest that socioeconomic factors might have majoreffect on production, which was also demonstrated by Yu 64] using multiple crop models.4.3. Potential for Integrating Prior KnowledgeIn this study, we tried to build data-driven model using the same environmental factors asmost crop models. However, the fact is that most data-driven models can only capture correlation butnot causality 65]. Therefore, integrating prior knowledge can improve the model performance andcredibility, which can be achieved by combining submodules in process models 66,67]. For regionalyield estimation in this study, the model could be constrained by some rules or physical laws that arealready clearly known and described mathematically in crop models.In addition, the inﬂuence of socioeconomic factors can also be expressed by some econometricmodels to ﬁt better yield trend than just using linear trend with the year. Figure 13is the linearregressed wheat yield of China using wheat planting inputs per unit area, including seeds, fertilizers,pesticides, and machinery, which were collected from “Compilation of national agricultural productcost-beneﬁt data” of China. Although the stagnation of yield growth in the 2000–2003 period is modeledwell, these kinds of data are collected afterwards, and so are not available before harvest and cannot beused to make yield prediction. Apparently, production inputs are affected by socioeconomic factorssuch as market prices and agricultural subsidies, which are available prior to harvest. This makes itpossible to quantitatively estimate the impact of socioeconomic factors in yield prediction by combiningsome econometric models.Figure 13. Linear regressed yield of China with input in agricultural production per Ha. The red line isthe wheat yield of China collected from Nation Bureau of Statistics. The blue line is the linear regressedyield using agricultural inputs. The green oval contains the results of 2000–2003.Remote Sens. 2020,12, 1744 17 of 205. ConclusionsIn this study, we developed deep learning model which combined remote sensing,meteorological, and soil data, to estimate the winter wheat yield in the main planting area of China atthe county level. The model was trained using the detrended statistical yield data and evaluated byleave-one-year-out-validation, and showed satisfactory accuracy of wheat yield prediction. Resultsalso showed that the yield forecast could be achieved at least one month prior to harvest with smallloss of accuracy. The uncertainty analysis was further conducted using an adjusted loss functionand Monte Carlo dropout. We found that yield detrending could possibly cause high uncertainty ofyield prediction and should be treated carefully when applied in crop yield prediction. The proposedmethod exhibits great potential for applications in other crop types and agricultural landscape regionsall over the world.Supplementary Materials: The following are available online at http://www.mdpi.com/2072-4292/12/11/1744/s1 Figure S1: Winter wheat yield forecasting accuracy with deep learning model from 1982 to 2015 beforedetrending yield, Figure S2: Winter wheat yield forecasting accuracy with deep learning model from 1982 to 2015after detrending yield, Figure S3: Locations of counties where MAPE is greater than 25% and the background isdistribution of irrigated and rainfed areas, Figure S4: Average yield of all years for each county.Author Contributions: Conceptualization, X.W. and J.H.; methodology, X.W.; writing—original draft preparation,X.W.; writing—review and editing, J.H., D.Y. and Q.F.; supervision, J.H. and Q.F. All authors have read and agreedto the published version of the manuscript.Funding: This research is supported by the National Key Research and Development Program of China (projectNo. 2018YFE0122700), National Natural Science Foundation of China (Project No. 41671418, 41971383) and ChinaPostdoctoral Science Foundation (Project No. 2018M641529, 2019T120155).Conﬂicts of Interest: The authors declare no conﬂict of interest.AbbreviationsThe following abbreviations are used in this manuscript:LAI Leaf Area IndexET EvapotranspirationLSTM Long Short-Term MemoryCNN Convolution Neural NetworksAVHRR Advanced Very High Resolution RadiometerNDVI Normalized Difference Vegetation IndexGEE Google Earth EngineGDAL The Geospatial Data Abstraction LibraryRMSE Root Mean Square ErrorNRMSE Normalized Root Mean Square ErrorR2Coefﬁcient Of DeterminationMAPE Mean Absolute Percentage ErrorReferences1. Lobell, D.B.; Cassman, K.G.; Field, C.B. Crop yield gaps: Their importance, magnitudes, and causes.Annu. Rev. Environ. Resour. 2009,34, 179–204. CrossRef ]2. Basso, B.; Cammarano, D.; Carfagna, E. Review of crop yield forecasting methods and early warning systems.In Proceedings of the First Meeting of the Scientiﬁc Advisory Committee of the Global Strategy to ImproveAgricultural and Rural Statistics, Rome, Italy, 18 July 2013; Volume 41.3. Schlenker, W.; Roberts, M.J. Nonlinear effects of weather on corn yields. Rev. Agric. Econ. 2006,28, 391–398.[CrossRef ]4. Huang, J.; Tian, L.; Liang, S.; Ma, H.; Becker-Reshef, I.; Huang, Y.; Su, W.; Zhang, X.; Zhu, D.; Wu, W.Improving winter wheat yield estimation by assimilation of the leaf area index from Landsat TM and MODISdata into the WOFOST model. Agric. For. Meteorol. 2015,204, 106–121. CrossRef ]Remote Sens. 2020,12, 1744 18 of 205. Huang, J.; Sedano, F.; Huang, Y.; Ma, H.; Li, X.; Liang, S.; Tian, L.; Zhang, X.; Fan, J.; Wu, W. Assimilating asynthetic Kalman ﬁlter leaf area index series into the WOFOST model to improve regional winter wheatyield estimation. Agric. For. Meteorol. 2016,216, 188–202. CrossRef ]6. Huang, J.; Ma, H.; Sedano, F.; Lewis, P.; Liang, S.; Wu, Q.; Su, W.; Zhang, X.; Zhu, D. Evaluation of regionalestimates of winter wheat yield by assimilating three remotely sensed reﬂectance datasets into the coupledWOFOST–PROSAIL model. Eur. J. Agron. 2019,102, 1–13. CrossRef ]7. Zhuo, W.; Huang, J.; Li, L.; Zhang, X.; Ma, H.; Gao, X.; Huang, H.; Xu, B.; Xiao, X. Assimilating soil moistureretrieved from Sentinel-1 and Sentinel-2 data into WOFOST model to improve winter wheat yield estimation.Remote Sens. 2019,11, 1618. CrossRef ]8. Moriondo, M.; Maselli, F.; Bindi, M. simple model of regional wheat yield based on NDVI data. Eur. J.Agron. 2007,26, 266–274. CrossRef ]9. Dubey, R.; Ajwani, N.; Kalubarme, M.; Sridhar, V.; Navalgund, R.; Mahey, R.; Sidhu, S.; Jhorar, O.; Cheema, S.;Na Rang, R. Pre-harvest wheat yield and production estimation for the Punjab, India. Int. J. Remote Sens.1994,15, 2137–2144. CrossRef ]10. Huang, J.; Gómez-Dans, J.L.; Huang, H.; Ma, H.; Wu, Q.; Lewis, P.E.; Liang, S.; Chen, Z.; Xue, J.H.; Wu, Y.; etal. Assimilation of remote sensing into crop growth models: Current status and perspectives. Agric. For.Meteorol. 2019,276, 107609. CrossRef ]11. Wall, L.; Larocque, D.; Léger, P.M. The early explanatory power of NDVI in crop yield modelling. Int. J.Remote Sens. 2008,29, 2211–2225. CrossRef ]12. Becker-Reshef, I.; Vermote, E.; Lindeman, M.; Justice, C. generalized regression-based model for forecastingwinter wheat yields in Kansas and Ukraine using MODIS data. Remote Sens. Environ. 2010,114, 1312–1323.[CrossRef ]13. Franch, B.; Vermote, E.; Becker-Reshef, I.; Claverie, M.; Huang, J.; Zhang, J.; Justice, C.; Sobrino, J. Improvingthe timeliness of winter wheat production forecast in the United States of America, Ukraine and Chinausing MODIS data and NCAR Growing Degree Day information. Remote Sens. Environ. 2015,161, 131–148.[CrossRef ]14. Doraiswamy, P.C.; Moulin, S.; Cook, P.W.; Stern, A. Crop yield assessment from remote sensing. Photogramm.Eng. Remote Sens. 2003,69, 665–674. CrossRef ]15. Patrício, D.I.; Rieder, R. Computer vision and artiﬁcial intelligence in precision agriculture for grain crops:A systematic review. Comput. Electron. Agric. 2018,153, 69–81. CrossRef ]16. Feng, Q.; Liu, J.; Gong, J. UAV remote sensing for urban vegetation mapping using random forest andtexture analysis. Remote Sens. 2015,7, 1074–1094. CrossRef ]17. Feng, Q.; Liu, J.; Gong, J. Urban ﬂood mapping based on unmanned aerial vehicle remote sensing andrandom forest classiﬁer—A case of Yuyao, China. Water 2015,7, 1437–1455. CrossRef ]18. Ali, I.; Greifeneder, F.; Stamenkovic, J.; Neumann, M.; Notarnicola, C. Review of machine learning approachesfor biomass and soil moisture retrievals from remote sensing data. Remote Sens. 2015,7, 16398–16421.[CrossRef ]19. Ip, R.H.; Ang, L.M.; Seng, K.P.; Broster, J.; Pratley, J. Big data and machine learning for crop protection.Comput. Electron. Agric. 2018,151, 376–383. CrossRef ]20. Jeong, J.H.; Resop, J.P.; Mueller, N.D.; Fleisher, D.H.; Yun, K.; Butler, E.E.; Timlin, D.J.; Shim, K.M.; Gerber, J.S.;Reddy, V.R.; et al. Random forests for global and regional crop yield predictions. PLoS ONE 2016,11, e0156571. CrossRef ]21. Han, J.; Zhang, Z.; Cao, J.; Luo, Y.; Zhang, L.; Li, Z.; Zhang, J. Prediction of Winter Wheat Yield Based onMulti-Source Data and Machine Learning in China. Remote Sens. 2020,12, 236. CrossRef ]22. Kuwata, K.; Shibasaki, R. Estimating corn yield in the united states with modis evi and machine learningmethods. ISPRS Ann. Photogramm. Remote Sens. Spat. Inf. Sci. 2016,3.[CrossRef ]23. Kim, N.; Lee, Y.W. Machine learning approaches to corn yield estimation using satellite images and climatedata: case of Iowa State. J. Korean Soc. Surv. Geod. Photogramm. Cartogr. 2016,34, 383–390. CrossRef ]24. Feng, Q.; Yang, J.; Zhu, D.; Liu, J.; Guo, H.; Bayartungalag, B.; Li, B. Integrating Multitemporal Sentinel-1/2Data for Coastal Land Cover Classiﬁcation Using Multibranch Convolutional Neural Network: Case ofthe Yellow River Delta. Remote Sens. 2019,11, 1006. CrossRef ]25. Hochreiter, S.; Schmidhuber, J. Long short-term memory. Neural Comput. 1997,9, 1735–1780. CrossRef ]Remote Sens. 2020,12, 1744 19 of 2026. You, J.; Li, X.; Low, M.; Lobell, D.; Ermon, S. Deep gaussian process for crop yield prediction based on remotesensing data. In Proceedings of the Thirty-First AAAI Conference on Artiﬁcial Intelligence, San Francisco,CA, USA, 4–9 February 2017.27. Wang, A.X.; Tran, C.; Desai, N.; Lobell, D.; Ermon, S. Deep transfer learning for crop yield prediction withremote sensing data. In Proceedings of the 1st ACM SIGCAS Conference on Computing and SustainableSocieties, Menlo Park and San Jose, CA, USA, 20–22 June 2018; pp. 1–5.28. Wolanin, A.; Mateo-García, G.; Camps-Valls, G.; Gómez-Chova, L.; Meroni, M.; Duveiller, G.; Liangzhi, Y.;Guanter, L. Estimating and understanding crop yields with explainable deep learning in the Indian WheatBelt. Environ. Res. Lett. 2020,15, 024019. CrossRef ]29. Jiang, Z.; Liu, C.; Hendricks, N.P.; Ganapathysubramanian, B.; Hayes, D.J.; Sarkar, S. Predicting county levelcorn yields using deep long short term memory models. arXiv 2018, arXiv:1805.12044.30. Oliveira, I.; Cunha, R.L.; Silva, B.; Netto, M.A. scalable machine learning system for pre-season agricultureyield forecast. arXiv 2018, arXiv:1806.09244.31. Qin, X.; Zhang, F.; Liu, C.; Yu, H.; Cao, B.; Tian, S.; Liao, Y.; Siddique, K.H. Wheat yield improvements inChina: Past trends and future directions. Field Crops Res. 2015,177, 117–124. CrossRef ]32. Wang, F.; He, Z.; Sayre, K.; Li, S.; Si, J.; Feng, B.; Kong, L. Wheat cropping systems and technologies in China.Field Crops Res. 2009,111, 181–188. CrossRef ]33. Li, X.; Liu, N.; You, L.; Ke, X.; Liu, H.; Huang, M.; Waddington, S.R. Patterns of cereal yield growth acrossChina from 1980 to 2010 and their implications for food production and food security. PLoS ONE 2016,11, e0159061. CrossRef ]34. Quiring, S.M.; Papakryiakou, T.N. An evaluation of agricultural drought indices for the Canadian prairies.Agric. For. Meteorol. 2003,118, 49–62. CrossRef ]35. Michel, L.; Makowski, D. Comparison of statistical models for analyzing wheat yield time series. PLoS ONE2013,8, e78615. CrossRef ][PubMed ]36. Lu, J.; Carbone, G.J.; Gao, P. Detrending crop yield data for spatial visualization of drought impacts in theUnited States, 1895–2014. Agric. For. Meteorol. 2017,237, 196–208. CrossRef ]37. Kendall, A.; Gal, Y. What uncertainties do we need in Bayesian deep learning for computer vision?In Proceedings of the NIPS 2017—2017 Conference on Neural Information Processing Systems, Long Beach,CA, USA, 4–9 December 2017; pp. 5575–5585.38. Vermote, E.; Justice, C.; Csiszar, I.; Eidenshink, J.; Myneni, R.; Baret, F.; Masuoka, E.; Wolfe, R.; Claverie, M.NOAA Climate Data Record (CDR) of AVHRR Surface Reﬂectance, Version ; NOAA National Centers forEnvironmental Information: Washington, DC, USA, 2019. Available online: https://doi.org/10.7289/V53776Z4 (accessed on December 2019).39. Chen, Y.; Yang, K.; He, J.; Qin, J.; Shi, J.; Du, J.; He, Q. Improving land surface temperature modeling for dryland of China. J. Geophys. Res. Atmos. 2011,116.[CrossRef ]40. Yang, K.; He, J.; Tang, W.; Qin, J.; Cheng, C.C. On downward shortwave and longwave radiations over highaltitude regions: Observation and modeling in the Tibetan Plateau. Agric. For. Meteorol. 2010,150, 38–46.[CrossRef ]41. Kun, Y. China Meteorological Forcing Dataset (1979–2018) National Tibetan Plateau Data Center, Institute ofTibetan Plateau Research, Chinese Academy of Sciences: Beijing, China 2018. CrossRef ]42. Hengl, T.; de Jesus, J.M.; Heuvelink, G.B.; Gonzalez, M.R.; Kilibarda, M.; Blagoti´ c, A.; Shangguan, W.;Wright, M.N.; Geng, X.; Bauer-Marschallinger, B.; et al. SoilGrids250m: Global gridded soil informationbased on machine learning. PLoS ONE 2017,12, e0169748. CrossRef ]43. Hengl, T.; de Jesus, J.M.; MacMillan, R.A.; Batjes, N.H.; Heuvelink, G.B.; Ribeiro, E.; Samuel-Rosa, A.;Kempen, B.; Leenaars, J.G.; Walsh, M.G.; et al. SoilGrids1km—Global soil information based on automatedmapping. PLoS ONE 2014,9, e105992. CrossRef ]44. Shao, Y.; Campbell, J.B.; Taff, G.N.; Zheng, B. An analysis of cropland mask choice and ancillary data forannual corn yield forecasting using MODIS data. Int. J. Appl. Earth Obs. Geoinf. 2015,38, 78–87. CrossRef ]45. Zhang, Y.; Chipanshi, A.; Daneshfar, B.; Koiter, L.; Champagne, C.; Davidson, A.; Reichert, G.; Bédard, F.Effect of using crop speciﬁc masks on earth observation based crop yield forecasting across Canada. RemoteSens. Appl. Soc. Environ. 2019,13, 121–137. CrossRef ]Remote Sens. 2020,12, 1744 20 of 2046. Liu, J.; Shang, J.; Qian, B.; Huffman, T.; Zhang, Y.; Dong, T.; Jing, Q.; Martin, T. Crop Yield Estimation UsingTime-Series MODIS Data and the Effects of Cropland Masks in Ontario, Canada. Remote Sens. 2019,11, 2419.[CrossRef ]47. Gorelick, N.; Hancher, M.; Dixon, M.; Ilyushchenko, S.; Thau, D.; Moore, R. Google Earth Engine:Planetary-scale geospatial analysis for everyone. Remote Sens. Environ. 2017.[CrossRef ]48. Holben, B.N. Characteristics of maximum-value composite images from temporal AVHRR data. Int. J.Remote Sens. 1986,7, 1417–1434. CrossRef ]49. Nair, V.; Hinton, G.E. Rectiﬁed linear units improve restricted boltzmann machines. In Proceedings of the27th International Conference on Machine Learning (ICML-10), Haifa, Israel, 21–24 June 2010; pp. 807–814.50. Kiureghian, A.D.; Ditlevsen, O. Aleatory or epistemic? Does it matter? Struct. Saf. 2009,31, 105–112.[CrossRef ]51. Gal, Y.; Ghahramani, Z. Dropout as Bayesian approximation: Representing model uncertainty in deeplearning. In Proceedings of the 33rd International Conference on Machine Learning, ICML 2016, New York,NY, USA, 19–24 June 2016; Volume 3, pp. 1651–1660.52. Abadi, M.; Agarwal, A.; Barham, P.; Brevdo, E.; Chen, Z.; Citro, C.; Corrado, G.S.; Davis, A.; Dean, J.;Devin, M.; et al. TensorFlow: Large-Scale Machine Learning on Heterogeneous Systems, 2015. Availableonline: tensorﬂow.org (accessed on 11 July 2019).53. He, K.; Zhang, X.; Ren, S.; Sun, J. Delving Deep into Rectiﬁers: Surpassing Human-Level Performance onImageNet Classiﬁcation. In Proceedings of the 2015 IEEE International Conference on Computer Vision(ICCV), Santiago, Chile, 7–13 December 2015; pp. 1026–1034. CrossRef ]54. Kingma, D.P.; Ba, J. Adam: method for stochastic optimization. arXiv 2014, arXiv:1412.6980.55. Bolton, D.K.; Friedl, M.A. Forecasting crop yield using remotely sensed vegetation indices and cropphenology metrics. Agric. For. Meteorol. 2013,173, 74–84. CrossRef ]56. Schut, A.; Stephens, D.; Stovold, R.; Adams, M.; Craig, R. Improved wheat yield and production forecastingwith moisture stress index, AVHRR and MODIS data. Crop Pasture Sci. 2009,60, 60–70. CrossRef ]57. Mkhabela, M.; Bullock, P.; Raj, S.; Wang, S.; Yang, Y. Crop yield forecasting on the Canadian Prairies usingMODIS NDVI data. Agric. For. Meteorol. 2011,151, 385–393. CrossRef ]58. LeCun, Y.; Bengio, Y.; Hinton, G. Deep learning. Nature 2015,521, 436–444. CrossRef ]59. Breiman, L.; et al. Statistical modeling: The two cultures (with comments and rejoinder by the author).Stat. Sci. 2001,16, 199–231. CrossRef ]60. Gal, Y. Uncertainty in Deep Learning. Ph.D. Thesis, University of Cambridge, Cambridge, UK, 2016.61. Zhu, X. Analysis of China’s Grain Supply and Demand Balance. Probl. Agric. Econ. 2004,4, 12–19. CrossRef ]62. Li, Y.; Zhang, W.; Ma, L.; Wu, L.; Shen, J.; Davies, W.J.; Oenema, O.; Zhang, F.; Dou, Z. An analysis of China’sgrain production: Looking back and looking forward. Food Energy Secur. 2014,3, 19–32. CrossRef ]63. Zhang Zhao, Wang Pin, Zhang Shuai, Tao Fulu, L.X. Spatio-temporal changes of agrometrorological disastersfor wheat production across China since 1990. Acta Geogr. Sin. 2013,68.[CrossRef ]64. Yu, C.; Huang, X.; Chen, H.; Huang, G.; Ni, S.; Wright, J.S.; Hall, J.; Ciais, P.; Zhang, J.; Xiao, Y.; et al. Assessingthe Impacts of Extreme Agricultural Droughts in China Under Climate and Socioeconomic Changes. Earth’sFuture 2018,6, 689–703. CrossRef ]65. Schölkopf, B. Causality for Machine Learning. arXiv 2019, arXiv:cs.LG/1911.10500.66. Reichstein, M.; Camps-Valls, G.; Stevens, B.; Jung, M.; Denzler, J.; Carvalhais, N.; et al. Deep learning andprocess understanding for data-driven Earth system science. Nature 2019,566, 195–204. CrossRef ]67. Jia, X.; Willard, J.; Karpatne, A.; Read, J.; Zwart, J.; Steinbach, M.; Kumar, V. Physics guided RNNs formodeling dynamical systems: case study in simulating lake temperature proﬁles. In Proceedings of the2019 SIAM International Conference on Data Mining, Calgary, AB, Canada, 2–4 May 2019; pp. 558–566.c2020 by the authors. Licensee MDPI, Basel, Switzerland. This article is an open accessarticle distributed under the terms and conditions of the Creative Commons Attribution(CC BY) license http://creativecommons.org/licenses/by/4.0/ ).